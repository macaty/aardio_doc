
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.activeX 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.activeX 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.activeX 库模块帮助文档</h1>

<p><details>  <summary>说明</summary>  <p>
请通过『工程向导 / 其他 / 创建 ActiveX EXE』创建 com.activeX 对象。</p>

<p>创建 ActiveX EXE 时一般不需要改动 *.odl 类型库声明文件。
保持默认就可以，所有接口函数可用 com.activeX 自动导出。</p>

<p>如果要自定义类型库，
建议继承 aardio.idl 提供的 IDispeatchExecutable 接口。</p>

<p>类型库中所有 DISPID 不应大于 10000 ，
这是因为aardio 自动生成 DISPID 以 10000 为起始值递增。</p>

<p>所有 aardio 表对象、函数对象都实现了 IDispatch 接口，
表对象可在 DISPID_NEWENUM 调用时返回 IEnumVARIANT 枚举接口。
</p></details></p>

<p><a id="com"></a></p>

<h2>com 成员列表</h2>

<p><a id="com.activeX"></a></p>

<h3>com.activeX(progId,version)</h3>

<p>创建 ActiveX 控件。<br>
参数 @progId 用一个字符串指定 ProgId。<br>
可选用 @version 指定版本数值，默认值为 1。  </p>

<p>请通过『工程向导 / 其他 / 创建 ActiveX EXE』使用此对象。</p>

<p><a id="com.activeX"></a></p>

<h2>com.activeX 成员列表</h2>

<p>用于创建或注册 ActiveX 控件。</p>

<p><a id="com.activeX.appData"></a></p>

<h3>com.activeX.appData(path,data)</h3>

<p>将@path指定的相对路径转换为系统AppData目录下的绝对路径,<br>
可选使用@data指定需要存入的数据,<br>
只有在存入字节与目标文件内容长度不同时才会更新文件。<br>
最后使用该路径自动注册控件,不需要管理权限。</p>

<p><a id="com.activeX.createEmbed"></a></p>

<h3>com.activeX.createEmbed(formOrCtrl,clsid,embedObj,filepath,appData)</h3>

<p>嵌入 @clsid 指定的控件到 @formOrCtrl 指定的窗口或控件,<br>
此函数返回控件容器,可选用 @embedObj 参数指定控件容器,<br>
关于控件容器请参数 com.CreateEmbed 函数说明,<br>
如果控件未注册,则注册 @filepath 参数指定路径的控件,<br>
如果指定了appData参数,<br>
则将@filepath,@appData传入 io.appData 获取路径</p>

<p><a id="com.activeX.createObject"></a></p>

<h3>com.activeX.createObject(clsid,filepath,appData)</h3>

<p>创建并返回 @clsid 指定 CLSID 的对象,<br>
如果控件未注册,则注册 @filepath 参数指定路径的控件,<br>
如果指定了appData参数,<br>
则将@filepath,@appData传入 io.appData 获取路径</p>

<p><a id="com.activeX.install"></a></p>

<h3>com.activeX.install(&quot;字符串参数&quot;,true,...)</h3>

<p>安装控件,可添加任意个命令行参数,<br>
如果需要管理权限则申请管理权限</p>

<p><a id="com.activeX.install"></a></p>

<h3>com.activeX.install()</h3>

<p>尝试用普通权限安装控件<br>
如果失败则申请管理权限注册控件</p>

<p><a id="com.activeX.license"></a></p>

<h3>com.activeX.license(clsid,licKey)</h3>

<p>参数@1为类名或GUID，<br>
参数@2为授权码</p>

<p><a id="com.activeX.registerSafeForScripting"></a></p>

<h3>com.activeX.registerSafeForScripting(&quot;CLSID&quot;)</h3>

<p>注册类名为脚本安全<br>
参数可以是CLSID或已注册ProgID</p>

<p><a id="com.activeX.regsvr32"></a></p>

<h3>com.activeX.regsvr32(&quot;字符串参数&quot;)</h3>

<p>尝试用当前进程相同的权限注册控件,参数@1指定dll路径,<br>
如果~/或~\开头的路径不存在，自动转换为/或\开头的路径重试。  </p>

<p>参数 @3 为 null 则进程有管理权限为所有用户注册，否则为当前用户注册。<br>
参数 @3 为 false 则始终仅为当前用户注册控件，<br>
为 true 则始终为所有用户注册控件（管理权限）。</p>

<p><a id="com.activeX.regsvr32"></a></p>

<h3>com.activeX.regsvr32(&quot;字符串参数&quot;,false)</h3>

<p>尝试用当前进程相同的权限卸载外部控件,参数@1指定dll路径,<br>
如果~/或~\开头的路径不存在，自动转换为/或\开头的路径重试。  </p>

<p>参数 @3 为 null 则进程有管理权限为所有用户卸载，否则为当前用户卸载。<br>
参数 @3 为 false 则始终仅为当前用户卸载控件，<br>
为 true 则始终为所有用户卸载控件（管理权限）。</p>

<p><a id="com.activeX.regsvr32As"></a></p>

<h3>com.activeX.regsvr32As(&quot;字符串参数&quot;)</h3>

<p>注册外部控件,<br>
如果需要管理权限则申请管理权限</p>

<p><a id="com.activeX.regsvr32As"></a></p>

<h3>com.activeX.regsvr32As(&quot;字符串参数&quot;,false)</h3>

<p>卸载外部控件,<br>
如果需要管理权限则申请管理权限</p>

<p><a id="comActiveXObject"></a></p>

<h2>comActiveXObject 成员列表</h2>

<p><a id="comActiveXObject.main"></a></p>

<h3>comActiveXObject.main()</h3>

<p>该函数检测传入参数并执行相应操作<br>
/r 注册控件 /u卸载控件 /Automation 运行</p>

<p><a id="comActiveXObject.register"></a></p>

<h3>comActiveXObject.register()</h3>

<p>注册组件</p>

<p><a id="comActiveXObject.start"></a></p>

<h3>comActiveXObject.start()</h3>

<p>运行控件</p>

<p><a id="comActiveXObject.unRegister"></a></p>

<h3>comActiveXObject.unRegister()</h3>

<p>卸载组件</p>

<p><a href="activeX.md" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/activeX.md">Markdown 格式</a></p>

</body> 
</html>