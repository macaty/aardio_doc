
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.sapi.voice 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.sapi.voice 库模块帮助文档</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.sapi.voice 库模块帮助文档</h1>

<p><a id="com.sapi"></a></p>

<h2>com.sapi 成员列表</h2>

<p><a id="com.sapi.voice"></a></p>

<h3>com.sapi.voice</h3>

<p>SAPI语音对象,<br>
SAPI为正常系统自带组件，如果是精简过删除了SAPI组件的系统请自行安装修复该组件</p>

<p><a id="com.sapi.voice"></a></p>

<h3>com.sapi.voice()</h3>

<p>创建SAPI语音对象  </p>

<p><a href="#comsapivoiceObject">返回对象:comsapivoiceObject</a></p>

<p><a id="comsapivoiceObject"></a></p>

<h2>comsapivoiceObject 成员列表</h2>

<p><a id="comsapivoiceObject.displayUI"></a></p>

<h3>comsapivoiceObject.displayUI(hWndParent,title,typeOfUI,extraData)</h3>

<p>显示指定界面</p>

<p><a id="comsapivoiceObject.eachVoices"></a></p>

<h3>comsapivoiceObject.eachVoices()</h3>

<pre><code class="aardio language-aardio">for name,lang,gender,age,vendor,description in comsapivoiceObject.eachVoices(){
    /*遍历所有语音库,  
name为名称,lang为语言代码,gender为性别,age为年龄,vendor为厂商,description为详细说明*/
}
</code></pre>

<p><a id="comsapivoiceObject.event"></a></p>

<h3>comsapivoiceObject.event</h3>

<p>回调事件表  </p>

<p><a href="#comsapivoiceeventObject">返回对象:comsapivoiceeventObject</a></p>

<p><a id="comsapivoiceObject.getStatus"></a></p>

<h3>comsapivoiceObject.getStatus()</h3>

<p>返回当前状态  </p>

<p><a href="#comsapivoicestatusObject">返回对象:comsapivoicestatusObject</a></p>

<p><a id="comsapivoiceObject.getVoicesEx"></a></p>

<h3>comsapivoiceObject.getVoicesEx()</h3>

<p>返回数组,数组由所有语音库的属性列表组成<br>
如果在参数中使用一个字符串参数指定要返回的属性,<br>
则返回由所有语音库的对应属性值组成的数组</p>

<p><a id="comsapivoiceObject.isUiSupported"></a></p>

<h3>comsapivoiceObject.isUiSupported(typeOfUI,extraData)</h3>

<p>是否支持指定界面</p>

<p><a id="comsapivoiceObject.pause"></a></p>

<h3>comsapivoiceObject.pause()</h3>

<p>暂停朗读</p>

<p><a id="comsapivoiceObject.rate"></a></p>

<h3>comsapivoiceObject.rate</h3>

<p>说话速度，值范围从 -10到10</p>

<p><a id="comsapivoiceObject.resume"></a></p>

<h3>comsapivoiceObject.resume()</h3>

<p>继续朗读</p>

<p><a id="comsapivoiceObject.setVoice"></a></p>

<h3>comsapivoiceObject.setVoice()</h3>

<p>设置当前语音库</p>

<p><a id="comsapivoiceObject.setVoiceByAttributes"></a></p>

<h3>comsapivoiceObject.setVoiceByAttributes(必需属性,可选属性)</h3>

<p>使用属性设置语音库<br>
属性使用&quot;Attribute = Value&quot;或者&quot;Attribute != Value&quot; 格式的字符串表示</p>

<p><a id="comsapivoiceObject.setVoiceByIndex"></a></p>

<h3>comsapivoiceObject.setVoiceByIndex()</h3>

<p>使用索引设置语音库</p>

<p><a id="comsapivoiceObject.setVoiceByLanguage"></a></p>

<h3>comsapivoiceObject.setVoiceByLanguage()</h3>

<p>使用语言代码设置语音库<br>
804 表示中文,409表示英文</p>

<p><a id="comsapivoiceObject.setVoiceByName"></a></p>

<h3>comsapivoiceObject.setVoiceByName()</h3>

<p>使用名称设置语音库</p>

<p><a id="comsapivoiceObject.skip"></a></p>

<h3>comsapivoiceObject.skip(type,numItems)</h3>

<p>跳过指定的文本</p>

<p><a id="comsapivoiceObject.speak"></a></p>

<h3>comsapivoiceObject.speak(text,flags)</h3>

<p>朗读,text参数指定要朗读的字符串<br>
flags为可选参数,可指定如下值：<br>
    SVSFDefault = 0<br>
    SVSFlagsAsync = 1<br>
    SVSFPurgeBeforeSpeak = 2<br>
    SVSFIsFilename = 4<br>
    SVSFIsXML = 8<br>
    SVSFIsNotXML = 16<br>
    SVSFPersistXML = 32<br>
    SVSFNLPSpeakPunc = 64<br>
    SVSFNLPMask = 64<br>
    SVSFVoiceMask = 127<br>
    SVSFUnusedFlags = -128</p>

<p><a id="comsapivoiceObject.speakAsync"></a></p>

<h3>comsapivoiceObject.speakAsync(text,flags)</h3>

<p>异步非阻塞朗读,text参数指定要朗读的字符串<br>
flags为可选参数,参考speak函数flags参数的说明<br>
此函数与speak用法相同,但flags默认指定了SVSFlagsAsync选项</p>

<p><a id="comsapivoiceObject.speakCompleteEvent"></a></p>

<h3>comsapivoiceObject.speakCompleteEvent()</h3>

<p>返回一个用于等待的事件句柄,<br>
可作为 thread.waitOne 的参数使用</p>

<p><a id="comsapivoiceObject.speakStream"></a></p>

<h3>comsapivoiceObject.speakStream(stream,flags)</h3>

<p>朗读文件流，例如SAPI.SpFileStream</p>

<p><a id="comsapivoiceObject.speakXml"></a></p>

<h3>comsapivoiceObject.speakXml(text,flags)</h3>

<p>异步非阻塞朗读XML格式文本,text参数指定要朗读的字符串<br>
flags为可选参数,参考speak函数flags参数的说明<br>
此函数与speak用法相同,但flags默认指定了SVSFlagsAsync,SVSFIsXML选项</p>

<p><a id="comsapivoiceObject.status"></a></p>

<h3>comsapivoiceObject.status</h3>

<p>当前状态  </p>

<p><a href="#comsapivoicestatusObject">返回对象:comsapivoicestatusObject</a></p>

<p><a id="comsapivoiceObject.voice"></a></p>

<h3>comsapivoiceObject.voice</h3>

<p>当前语音库</p>

<p><a id="comsapivoiceObject.volume"></a></p>

<h3>comsapivoiceObject.volume</h3>

<p>音量，值范围从 0到100</p>

<p><a id="comsapivoiceObject.waitOne"></a></p>

<h3>comsapivoiceObject.waitOne()</h3>

<p>异步朗读时,可使用此函数等待朗读结束</p>

<p><a id="comsapivoiceObject.waitUntilDone"></a></p>

<h3>comsapivoiceObject.waitUntilDone(_)</h3>

<p>等待直到完成,参数指定超时,超时指定为-1表示直到朗读完成</p>

<p><a id="comsapivoiceeventObject"></a></p>

<h2>comsapivoiceeventObject 成员列表</h2>

<p><a id="comsapivoiceeventObject.AudioLevel"></a></p>

<h3>comsapivoiceeventObject.AudioLevel</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.AudioLevel = function(streamNumber,streamPosition,audioLevel){ 
    /*音频变化触发*/  
}
</code></pre>

<p><a id="comsapivoiceeventObject.EndStream"></a></p>

<h3>comsapivoiceeventObject.EndStream</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.EndStream = function(streamNumber ,streamPosition){ 

}
</code></pre>

<p><a id="comsapivoiceeventObject.EnginePrivate"></a></p>

<h3>comsapivoiceeventObject.EnginePrivate</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.EnginePrivate =  function(streamNumber,streamPosition,engineData){

}
</code></pre>

<p><a id="comsapivoiceeventObject.Phoneme"></a></p>

<h3>comsapivoiceeventObject.Phoneme</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.Phoneme =  function(streamNumber, streamPosition,Duration,nextPhoneId,Feature,currentPhoneId){
   /*新的音素*/
}
</code></pre>

<p><a id="comsapivoiceeventObject.Sentence"></a></p>

<h3>comsapivoiceeventObject.Sentence</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.Sentence =  function(streamNumber,streamPosition,characterPosition,length){
   /*新的句子*/
}
</code></pre>

<p><a id="comsapivoiceeventObject.StartStream"></a></p>

<h3>comsapivoiceeventObject.StartStream</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.StartStream = function(streamNumber,streamPosition ){ 

}
</code></pre>

<p><a id="comsapivoiceeventObject.Viseme"></a></p>

<h3>comsapivoiceeventObject.Viseme</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.Viseme =  function(streamNumber,streamPosition,duration,nextVisemeId,feature,currentVisemeId){
   /*新的嘴形*/
}
</code></pre>

<p><a id="comsapivoiceeventObject.VoiceChange"></a></p>

<h3>comsapivoiceeventObject.VoiceChange</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.VoiceChange =  function(streamNumber,streamPosition ,voiceObjectToken ){ 
    var v = voiceObjectToken.GetDescription();
}
</code></pre>

<p><a id="comsapivoiceeventObject.Word"></a></p>

<h3>comsapivoiceeventObject.Word</h3>

<pre><code class="aardio language-aardio">comsapivoiceeventObject.Word =  function(streamNumber,streamPosition,characterPosition,length ){ 
   /*一个新单词开始*/
}
</code></pre>

<p><a id="comsapivoicestatusObject"></a></p>

<h2>comsapivoicestatusObject 成员列表</h2>

<p><a id="comsapivoicestatusObject.currentStreamNumber"></a></p>

<h3>comsapivoicestatusObject.currentStreamNumber</h3>

<p>输入流数目.</p>

<p><a id="comsapivoicestatusObject.inputSentenceLength"></a></p>

<h3>comsapivoicestatusObject.inputSentenceLength</h3>

<p>当前语句长度</p>

<p><a id="comsapivoicestatusObject.inputSentencePosition"></a></p>

<h3>comsapivoicestatusObject.inputSentencePosition</h3>

<p>当前语句开始位置</p>

<p><a id="comsapivoicestatusObject.inputWordLength"></a></p>

<h3>comsapivoicestatusObject.inputWordLength</h3>

<p>当前朗读的单词长度</p>

<p><a id="comsapivoicestatusObject.inputWordPosition"></a></p>

<h3>comsapivoicestatusObject.inputWordPosition</h3>

<p>当前朗读的单词开始位置</p>

<p><a id="comsapivoicestatusObject.lastBookmark"></a></p>

<h3>comsapivoicestatusObject.lastBookmark</h3>

<p>最后一个书签的字符串值</p>

<p><a id="comsapivoicestatusObject.lastBookmarkId"></a></p>

<h3>comsapivoicestatusObject.lastBookmarkId</h3>

<p>最后一个书签的ID</p>

<p><a id="comsapivoicestatusObject.lastHResult"></a></p>

<h3>comsapivoicestatusObject.lastHResult</h3>

<p>最后一次调用speak,speakStream的状态码</p>

<p><a id="comsapivoicestatusObject.lastStreamNumberQueued"></a></p>

<h3>comsapivoicestatusObject.lastStreamNumberQueued</h3>

<p>朗读的最后一个音频流编号</p>

<p><a id="comsapivoicestatusObject.phonemeId"></a></p>

<h3>comsapivoicestatusObject.phonemeId</h3>

<p>当前音素ID</p>

<p><a id="comsapivoicestatusObject.runningState"></a></p>

<h3>comsapivoicestatusObject.runningState</h3>

<p>当前朗读状态<br>
SRSEIsSpeaking 值为2 表示正在朗读<br>
SRSEDone 值为1表示朗读已完成</p>

<p><a id="comsapivoicestatusObject.visemeId"></a></p>

<h3>comsapivoicestatusObject.visemeId</h3>

<p>当前口形ID</p>

<p><a href="voice.md" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/sapi/voice.md">Markdown 格式</a></p>

</body> 
</html>