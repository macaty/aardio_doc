
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.wmi 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.wmi 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.wmi 库模块帮助文档</h1>

<p><a id="com"></a></p>

<h2>com 成员列表</h2>

<p><a id="com.wmi"></a></p>

<h3>com.wmi()</h3>

<p><a href="#ComObject">返回对象:ComObject</a></p>

<p><a id="com.wmi"></a></p>

<h3>com.wmi(path,computer)</h3>

<p>创建并返回 WMI 客户端对象,失败返回 null,<br>
所有参数可省略,<br>
@path 默认为 &quot;\root\cimv2&quot;<br>
@computer 默认为&quot;.&quot;</p>

<p><a id="com.wmi"></a></p>

<h2>com.wmi 成员列表</h2>

<p>WMI / Windows Management Instrumentation 客户端。<br>
用法也可可参考 com.monitor 库源码，以及『 范例 / COM 组件 / WMI 』。<br>
参考文档 <a href="../../../../../docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-reference" tppabs="https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-reference">https://docs.microsoft.com/en-us/windows/win32/wmisdk/wmi-reference</a></p>

<p>创建 WMI 客户端对象,失败返回 null</p>

<p><a id="com.wmi.each"></a></p>

<h3>com.wmi.each()</h3>

<p><a href="#SWbemObject">返回对象:SWbemObject</a></p>

<p><a id="com.wmi.each"></a></p>

<h3>com.wmi.each(wql,path,...)</h3>

<pre><code class="aardio language-aardio">for index,item in com.wmi.each(&quot;/*遍历 WMI 对象,  
可输入WQL查询语句或类名  
可选用参数@2指定 WMI 路径,默认为 &quot;\root\cimv2&quot;  

可选用参数@3及后续参数指定格式化参数,  
如果格式化参数是表,则可省略 @path 且不用保留参数位置,  
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,  
如果参数不是一个表,则调用 string.format 格式化*/&quot;) {

}
</code></pre>

<p><a id="com.wmi.eachNotification"></a></p>

<h3>com.wmi.eachNotification(wql,path,...)</h3>

<pre><code class="aardio language-aardio">for event,targetInstance in com.wmi.eachNotification(&quot;/*遍历 WMI 查询事件通知，同步阻塞执行。  
可输入WQL查询语句或类名  
可选用参数@2指定 WMI 路径,默认为 &quot;\root\cimv2&quot;  

可选用参数@3及后续参数指定格式化参数,  
如果格式化参数是表,则可省略 @path 且不用保留参数位置,  
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,  
如果参数不是一个表,则调用 string.format 格式化*/&quot;) {

}
</code></pre>

<p><a id="com.wmi.eachProperties"></a></p>

<h3>com.wmi.eachProperties(wql,path,...)</h3>

<pre><code class="aardio language-aardio">for item in com.wmi.eachProperties(&quot;/*遍历 WMI 对象的属性表,  
可输入WQL查询语句或类名  
可选用参数@2指定 WMI 路径,默认为 &quot;\root\cimv2&quot;  

可选用参数@3及后续参数指定格式化参数,  
如果格式化参数是表,则可省略 @path 且不用保留参数位置,  
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,  
如果参数不是一个表,则调用 string.format 格式化*/&quot;) {

}
</code></pre>

<p><a id="com.wmi.formatWqlParameters"></a></p>

<h3>com.wmi.formatWqlParameters</h3>

<p>格式化参数 @1 指定的 WQL 语句,<br>
com.wmi.query 等函数调用此函数格式化 WQL 语句</p>

<p><a id="com.wmi.formatWqlParameters"></a></p>

<h3>com.wmi.formatWqlParameters(wql,...)</h3>

<p>格式化参数 @1 指定的 WQL 语句,<br>
参数@2及后续参数指定格式化参数,<br>
支持 @号 开头的命名参数或以 ? 号为占位符的匿名参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.get"></a></p>

<h3>com.wmi.get</h3>

<p>可输入WQL查询语句或类名,<br>
返回首个查询结果</p>

<p><a id="com.wmi.get"></a></p>

<h3>com.wmi.get()</h3>

<p><a href="#SWbemObject">返回对象:SWbemObject</a></p>

<p><a id="com.wmi.get"></a></p>

<h3>com.wmi.get(wql)</h3>

<p>参数 @wql 可输入WQL查询语句或类名,<br>
成功则返回首个查询结果,<br>
可选用参数@3指定 WMI 路径,默认为 &quot;\root\cimv2&quot;<br>
可选用参数@4及后续参数指定格式化参数,<br>
支持 @号 开头的命名参数或以 ? 号为占位符的匿名参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.get"></a></p>

<h3>com.wmi.get(wql,property,path,...)</h3>

<p>参数 @wql 可输入WQL查询语句或类名,<br>
成功则返回首个查询结果中 @property 参数指定的属性值<br>
失败返回 null,<br>
可选用参数@path指定 WMI 路径,默认为 &quot;\root\cimv2&quot;<br>
可选用参数@4及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @property,@path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.getProperties"></a></p>

<h3>com.wmi.getProperties</h3>

<p>返回所有属性</p>

<p><a id="com.wmi.getProperties"></a></p>

<h3>com.wmi.getProperties(wmiObject)</h3>

<p>参数 @wmiObject 可输入 WMI 对象,<br>
返回该对象所有属性组成的表,表以属性名为键,属性值为值,<br>
失败返回 null</p>

<p><a id="com.wmi.getProperties"></a></p>

<h3>com.wmi.getProperties(wql,path,...)</h3>

<p>参数 @wql 可输入WQL查询语句或类名,<br>
可选用参数@path 指定 WMI 路径,默认为 &quot;\root\cimv2&quot;,<br>
返回首个查询结果中所有属性组成的表,表以属性名为键,属性值为值,<br>
失败返回 null  </p>

<p>可选用参数@3及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.getTable"></a></p>

<h3>com.wmi.getTable(wql,path,...)</h3>

<p>查询并返回包含所有返回 WMI 对象的属性表的数组<br>
 @wql 参数可输入WQL查询语句或类名,<br>
可选用参数@path 指定 WMI 路径,默认为 &quot;\root\cimv2&quot;  </p>

<p>可选用参数@3及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的匿名参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.query"></a></p>

<h3>com.wmi.query</h3>

<p>执行 WQL 查询</p>

<p><a id="com.wmi.query"></a></p>

<h3>com.wmi.query(wql,path,...)</h3>

<p>参数 @wql 可输入 WQL 查询语句或类名,<br>
调用 ExecQuery 返回查询结果,<br>
可选用参数 @path 指定 WMI 路径,默认为 &quot;\root\cimv2&quot;<br>
可选用参数@3及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的数组参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.queryAsync"></a></p>

<h3>com.wmi.queryAsync</h3>

<p>执行异步 WQL 查询</p>

<p><a id="com.wmi.queryAsync"></a></p>

<h3>com.wmi.queryAsync(objSink,wql,path,...)</h3>

<p>参数 @objSink 可指定 com.wmi.sink 对象，或者创建该对象的参数表。<br>
参数 @wql 可输入 WQL 查询语句或类名,<br>
调用 ExecQuery 返回查询结果,<br>
可选用参数 @path 指定 WMI 路径,默认为 &quot;\root\cimv2&quot;<br>
可选用参数@3及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的数组参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.queryNotificationAsync"></a></p>

<h3>com.wmi.queryNotificationAsync</h3>

<p>执行异步 WQL 查询以接收事件</p>

<p><a id="com.wmi.queryNotificationAsync"></a></p>

<h3>com.wmi.queryNotificationAsync(objSink,wql,path,...)</h3>

<p>参数 @objSink 可指定 com.wmi.sink 对象，或者创建该对象的参数表。<br>
参数 @wql 可输入 WQL 查询语句或类名,<br>
调用 ExecQuery 返回查询结果,<br>
可选用参数 @path 指定 WMI 路径,默认为 &quot;\root\cimv2&quot;<br>
可选用参数@3及后续参数指定格式化参数,<br>
如果格式化参数是表,则可省略 @path 且不用保留参数位置,<br>
参数表可格式化 @号 开头的命名参数或以 ? 号为占位符的数组参数,<br>
如果参数不是一个表,则调用 string.format 格式化</p>

<p><a id="com.wmi.sink"></a></p>

<h3>com.wmi.sink(event)</h3>

<pre><code class="aardio language-aardio">com.wmi.sink(  
    OnCompleted = function(hResult,wbemErrorObject,wbemAsyncContext){  

    };  
    OnObjectPut = function(wbemObjectPath,wbemAsyncContext){  

    };  
    OnObjectReady = function(wbemObject,wbemAsyncContext){  

    };  
    OnProgress = function(upperBound,current,message,wbemAsyncContext){  

    };  
)
</code></pre>

<p><a id="ComObject"></a></p>

<h2>ComObject 成员列表</h2>

<p><a id="ComObject.ExecNotificationQuery"></a></p>

<h3>ComObject.ExecNotificationQuery(wqlQuery)</h3>

<p>执行查询并接收事件</p>

<p><a id="ComObject.ExecNotificationQueryAsync"></a></p>

<h3>ComObject.ExecNotificationQueryAsync(sinkObj,wqlQuery)</h3>

<p>执行异步查询以接收事件,<br>
参数@1必须传入 com.wmi.sink 创建的对象,<br>
参数@2指定 WQL 查询语句<br>
更多参数说明请参考 <a href="../../../../../docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execnotificationquery" tppabs="https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execnotificationquery">https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execnotificationquery</a></p>

<p><a id="ComObject.ExecQuery"></a></p>

<h3>ComObject.ExecQuery(&quot;SELECT * FROM Win32_BaseBoard&quot;)</h3>

<p>使用 WQL 进行查询,返回 COM 对象,<br>
参数@2必须省略,可选用参数@3指定选项,<br>
半同步优化请将参数@3指定以下值 _wbemFlagReturnImmediately | _wbemFlagForwardOnly<br>
更多参数说明请参考 <a href="../../../../../docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execquery" tppabs="https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execquery">https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execquery</a></p>

<p><a id="ComObject.ExecQueryAsync"></a></p>

<h3>ComObject.ExecQueryAsync(sinkObj,wqlQuery)</h3>

<p>异步查询对象，<br>
参数@1必须传入 com.wmi.sink 创建的对象,<br>
参数@2指定 WQL 查询语句。<br>
更多参数说明请参考 <a href="../../../../../docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execqueryasync" tppabs="https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execqueryasync">https://docs.microsoft.com/en-us/windows/win32/wmisdk/swbemservices-execqueryasync</a></p>

<p><a id="ComObject.InstancesOf"></a></p>

<h3>ComObject.InstancesOf(strClass,iFlags)</h3>

<p>根据指定的类名,返回可使用 com.each 遍历的对象</p>

<p><a id="SWbemObject"></a></p>

<h2>SWbemObject 成员列表</h2>

<p><a id="SWbemObject.Delete_"></a></p>

<h3>SWbemObject.Delete_</h3>

<p>删除对象</p>

<p><a id="SWbemObject.PutAsync_"></a></p>

<h3>SWbemObject.PutAsync_</h3>

<p>异步创建或更新 WMI 对象</p>

<p><a id="SWbemObject.Put_"></a></p>

<h3>SWbemObject.Put_()</h3>

<p>创建或更新 WMI 对象,<br>
修改属性后要调用这个函数才会生效,<br>
进程可能需要管理权限</p>

<h3>自动完成常量</h3>

<p>_wbemFlagForwardOnly=32<br>
_wbemFlagReturnImmediately=16  </p>

<p><a href="wmi.md" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/wmi.md">Markdown 格式</a></p>

</body> 
</html>