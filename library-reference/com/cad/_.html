
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.cad 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.cad 库模块帮助文档</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.cad 库模块帮助文档</h1>

<p><details>  <summary>模板语法</summary>  <p>
com.cad.sendCopyData 函数
以及 com.cad 对象的 LispExp,SendCommand 函数
支持<a href="../../../language-reference/templating/syntax.html" tppabs="https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax.html">模板语法</a></p>

<p>LISP 模板由 com.cad.loadcode() 函数解析，
转换规则如下：</p>

<p>一、如果 aardio 输出非空数组或多个参数 ，
所有参数按以下规则转换为字符串。</p>

<ol>
<li>数值直接输输出，flase 转为 nil ，true 转为 T</li>
<li>数组或嵌套的数组参数都会转换为 LISP 表（首尾有括号）， 
如果 cons 字段为 true 则转换为点对（首尾有括号）。</li>
<li>包含 car,cdr 成员的表会转换为点对（首尾有括号）。
其他名值对转换为关联列表。</li>
<li>其他类型统一调用 tostring() 转换为字符串，
然后按 LISP 语法进行转义，首尾加双引号。 </li>
</ol>

<p>最后将所有参数以空格分开输出到 LISP 代码（首尾不加括号）</p>

<p>二、单个表参数为包含 car,cdr 成员的表会转换为点对（首尾有括号）。
如果表参数为其他名值对则转换为关联列表（首尾有括号。</p>

<p>三、其他单个参数直接转为字符串并置入 LISP 代码。
</p></details></p>

<p><a id="com"></a></p>

<h2>com 成员列表</h2>

<p><a id="com.cad"></a></p>

<h3>com.cad()</h3>

<p>获取已存在的 AutoCAD 实例，或创建新的 AutoCAD 实例。<br>
兼容 32 位 / 64 位 AutoCAD。  </p>

<p><a href="#ComCadObject">返回对象:ComCadObject</a></p>

<p><a id="com.cad"></a></p>

<h2>com.cad 成员列表</h2>

<p>AutoCAD 支持库。<br>
兼容 32 位 / 64 位 AutoCAD</p>

<p><a id="com.cad.list"></a></p>

<h3>com.cad.list(array)</h3>

<p>aardio 数组转换为 LISP 表代码，<br>
参数 @2 为 true 时首尾不添加括号  </p>

<p>如果 car,cdr 字段不为 null 且不含数组成员，<br>
或包含数组成员，但 cons 字段为 true，<br>
则返回点对，点对总是在首尾添加括号。<br>
其他名值对转换为关联列表。</p>

<p><a id="com.cad.loadcode"></a></p>

<h3>com.cad.loadcode()</h3>

<p>加载 aardio 模板代码返回 LISP 代码，<br>
可指定多个模板参数</p>

<p><a id="com.cad.sendCopyData"></a></p>

<h3>com.cad.sendCopyData(hwnd,data,args,dataType)</h3>

<p>用 _WM_COPYDATA 向 AutoCAD 窗口发送数据。<br>
@hwnd 为 AutoCAD 主窗口句柄，<br>
@data 为 需要发送的字符串，发送命令时支持模板语法，<br>
@args 发送命令时，可选用这个参数指定@data 使用的模板参数，<br>
@dataType 省略时默认值为1，为 1 表示发送到 AutoCAD 命令窗口并执行该命令。<br>
发送成功返回1，否则返回0</p>

<p><a id="ComCadDocObject"></a></p>

<h2>ComCadDocObject 成员列表</h2>

<p><a id="ComCadDocObject.Activate"></a></p>

<h3>ComCadDocObject.Activate()</h3>

<p>激活文档</p>

<p><a id="ComCadDocObject.Close"></a></p>

<h3>ComCadDocObject.Close(saveChanges,filename)</h3>

<p>关闭文档<br>
可选用 @saveChanges 指定是否保存更改。<br>
@filename 的綻文件路径，建议用 io.fullpath 转换为完整路径</p>

<p><a id="ComCadDocObject.GetVariable"></a></p>

<h3>ComCadDocObject.GetVariable(name)</h3>

<p>获取系统变量值</p>

<p><a id="ComCadDocObject.Name"></a></p>

<h3>ComCadDocObject.Name</h3>

<p>名称，只读</p>

<p><a id="ComCadDocObject.Path"></a></p>

<h3>ComCadDocObject.Path</h3>

<p>路径，不含文件名</p>

<p><a id="ComCadDocObject.ReadOnly"></a></p>

<h3>ComCadDocObject.ReadOnly</h3>

<p>是否只读模式</p>

<p><a id="ComCadDocObject.Save"></a></p>

<h3>ComCadDocObject.Save()</h3>

<p>保存文档</p>

<p><a id="ComCadDocObject.SaveAs"></a></p>

<h3>ComCadDocObject.SaveAs(fileName,fileType,securityParams)</h3>

<p>保存文件<br>
@fileName 指定文件路径，请用 io.fullpath 先转换为完整路径。<br>
@fileType 指定保存类型（枚举类型 AcSaveAsType ），<br>
└── 可用 console.dump 列出 COM 对象枚举类型的可用名值对<br>
└── 枚举名可作为 COM 对象的成员名获取枚举值<br>
@securityParams 为可选参当，用法请参考 AutoCAD 文档</p>

<p><a id="ComCadDocObject.Saved"></a></p>

<h3>ComCadDocObject.Saved</h3>

<p>是否已保存所有更改</p>

<p><a id="ComCadDocObject.SetVariable"></a></p>

<h3>ComCadDocObject.SetVariable(name,value)</h3>

<p>设置系统变量值，<br>
@name 指定变量名，@value 变量值，值的类型一定要匹配，<br>
VBA里的 Integer 类型 0 在 aardio 中要写为 com.word(0)，<br>
VBA里的 Double  类型 0 在 aardio 中要写为 com.double(0)</p>

<p><a id="ComCadDocObject.WindowState"></a></p>

<h3>ComCadDocObject.WindowState</h3>

<p>文档状态，可读写。<br>
通过此对象的成员名字可获取此属性可用的 COM 常量值：<br>
acMin 窗口为最小化<br>
acMax 窗口为最大化<br>
acNorm  窗口为常规窗</p>

<p><a id="ComCadLspFunctionsObject"></a></p>

<h2>ComCadLspFunctionsObject 成员列表</h2>

<p><a id="ComCadLspFunctionsObject.?"></a></p>

<h3>ComCadLspFunctionsObject.?</h3>

<p>请指定需要调用的 Visual LISP 函数名，<br>
如果函数名包含横线等，也可以使用下标操作符，例如[&quot;函数名&quot;]</p>

<p><a id="ComCadLspFunctionsObject.eval"></a></p>

<h3>ComCadLspFunctionsObject.eval()</h3>

<p>计算并返回参数 @1 指定的 LISP 表达式的值</p>

<p><a id="ComCadLspFunctionsObject.read"></a></p>

<h3>ComCadLspFunctionsObject.read()</h3>

<p>读取字符串参数 @1 指定的 LISP 代码<br>
返回第一个表或第一个原子</p>

<p><a id="ComCadLspFunctionsObject.vl"></a></p>

<h2>ComCadLspFunctionsObject.vl 成员列表</h2>

<p><a id="ComCadLspFunctionsObject.vl.?"></a></p>

<h3>ComCadLspFunctionsObject.vl.?</h3>

<p>请指定需要调用的 Visual LISP 函数名（自动添加  &quot;vl-&quot; 前缀）。</p>

<p><a id="ComCadLspFunctionsObject.vl.cmdf"></a></p>

<h3>ComCadLspFunctionsObject.vl.cmdf(&quot;commandline&quot;)</h3>

<p>调用 vl-cmdf 函数执行命令。<br>
通过此接口只能调用 vl-cmdf 执行命令，调用 command  是无效的。</p>

<p><a id="ComCadObject"></a></p>

<h2>ComCadObject 成员列表</h2>

<p><a id="ComCadObject.ActiveDocument"></a></p>

<h3>ComCadObject.ActiveDocument</h3>

<p>当前活动文档，可读写属性  </p>

<p><a href="#ComCadDocObject">返回对象:ComCadDocObject</a></p>

<p><a id="ComCadObject.Application"></a></p>

<h3>ComCadObject.Application</h3>

<p>应用程序对象</p>

<p><a id="ComCadObject.Eval"></a></p>

<h3>ComCadObject.Eval()</h3>

<p>计算 VBA 表达式</p>

<p><a id="ComCadObject.GetAcCmColor"></a></p>

<h3>ComCadObject.GetAcCmColor()</h3>

<p>获取 AutoCAD 进程内颜色管理对象</p>

<p><a id="ComCadObject.GetAcadState"></a></p>

<h3>ComCadObject.GetAcadState().IsQuiescent</h3>

<p>AutoCAD 当前是静止状态</p>

<p><a id="ComCadObject.GetCadInterfaceObject"></a></p>

<h3>ComCadObject.GetCadInterfaceObject()</h3>

<p>使用参数指定的 ProgID 在 AutoCAD 进程内加载 AutoCAD 提供的 COM 对象,<br>
与 GetInterfaceObject 不同的是 GetCadInterfaceObject 会在参数后自动添加当前主版本号</p>

<p><a id="ComCadObject.GetInterfaceObject"></a></p>

<h3>ComCadObject.GetInterfaceObject()</h3>

<p>使用参数指定的 ProgID 在 AutoCAD 进程内加载 COM 对象</p>

<p><a id="ComCadObject.GetLayerStateManager"></a></p>

<h3>ComCadObject.GetLayerStateManager()</h3>

<p>获取 AutoCAD 进程内图层管理器对象</p>

<p><a id="ComCadObject.GetLispFunctions"></a></p>

<h3>ComCadObject.GetLispFunctions()</h3>

<p>获取活动文档 Visual LISP 函数列表。<br>
可通过调用返回对象的成员函数调用 LISP 函数。  </p>

<p>返回对象自身可作为生成 LISP 表达式的函数使用：<br>
参数可指定 aardio 数组或多个参数；<br>
也可以指定包含 car,cdr 字段的表，用于返回点对；<br>
参数为一个字符串时，作为 LISP 代码读取并返回表<br>
已知限制：<br>
1、此接口加载的 LISP 代码无法调用 command 命令<br>
2、AutoCAD 这个接口不太稳定，调用某些函数偶尔会出现  </p>

<p><a href="#ComCadLspFunctionsObject">返回对象:ComCadLspFunctionsObject</a></p>

<p><a id="ComCadObject.GetSecurityParams"></a></p>

<h3>ComCadObject.GetSecurityParams</h3>

<p>获取 AutoCAD 进程内安全参数对象</p>

<p><a id="ComCadObject.HWND"></a></p>

<h3>ComCadObject.HWND</h3>

<p>窗口句柄</p>

<p><a id="ComCadObject.LispExp"></a></p>

<h3>ComCadObject.LispExp()</h3>

<p>读取并执行字符串中的第一个 LISP 表达式，此函数无返回值。<br>
参数@1支持 aardio 模板语法，其他参数为模板参数。<br>
<a href="../../../language-reference/templating/syntax.html" tppabs="https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax.html">aardio 模板语法</a><br>
aardio 模板中非数值、非布尔值一律转字符串,<br>
一次输出多个模板参数或数组时，字符串自动转义并加引号，多参数以空格分开。<br>
已知限制：<br>
1、此接口加载的 LISP 代码无法调用 command 命令<br>
2、AutoCAD 这个接口不太稳定，调用某些函数偶尔会出现</p>

<p><a id="ComCadObject.ListARX"></a></p>

<h3>ComCadObject.ListARX()</h3>

<p>获取已加载的 ARX 应用程序</p>

<p><a id="ComCadObject.LoadARX"></a></p>

<h3>ComCadObject.LoadARX()</h3>

<p>加载参数@1指定的 ARX 应用程序</p>

<p><a id="ComCadObject.LoadDVB"></a></p>

<h3>ComCadObject.LoadDVB()</h3>

<p>加载 .dvb 工程，无返回值。<br>
参数 @1 指定 .dvb 工程文件路径。  </p>

<p>工程中名为 AcadStartup 的宏将自动运行。</p>

<p><a id="ComCadObject.LoadLisp"></a></p>

<h3>ComCadObject.LoadLisp</h3>

<p>加载 LISP 代码。<br>
参数支持[aardio 模板语法]<a href="../../../language-reference/templating/syntax" tppabs="https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax">https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax</a></p>

<p><a id="ComCadObject.LoadLisp"></a></p>

<h3>ComCadObject.LoadLisp(lisp,args,doc)</h3>

<p>加载 LISP 代码。<br>
参数@1可以是文件、资源文件、或 LISP 代码，<br>
支持 aardio 模板语法,可选用 @args 参数指定模板 owner 参数，<br>
可选用参数 @3 自定义执行此函数的文档对象。  </p>

<p>已加载的 LISP 代码无法卸载，可通过赋值 nil 删除定义的函数。</p>

<p><a id="ComCadObject.LoadLispFile"></a></p>

<h3>ComCadObject.LoadLispFile</h3>

<p>加载 *.lsp 代码文件</p>

<p><a id="ComCadObject.LoadLispFile"></a></p>

<h3>ComCadObject.LoadLispFile(path,doc)</h3>

<p>加载 *.lsp 代码文件，<br>
参数@1指定 *.lsp 代码文件路径，<br>
可选用参数 @2 自定义执行此函数的文档对象</p>

<p><a id="ComCadObject.MajorVersion"></a></p>

<h3>ComCadObject.MajorVersion()</h3>

<p>AutoCAD 主版本号，数值。<br>
例如 AutoCAD 2022 主版本号为 24。</p>

<p><a id="ComCadObject.MajorVersionString"></a></p>

<h3>ComCadObject.MajorVersionString()</h3>

<p>AutoCAD 主版本号，字符串值。<br>
例如 AutoCAD 2022 主版本号为 24。</p>

<p><a id="ComCadObject.NetCompiler"></a></p>

<h3>ComCadObject.NetCompiler(&quot;C#&quot;)</h3>

<p>使用当前线程默认应用程序域创建 C&num; 编译器。<br>
需要先导入 dotNet 库</p>

<p><a id="ComCadObject.NetCompiler"></a></p>

<h3>ComCadObject.NetCompiler()</h3>

<p><a href="#dotNetCompilerObject">返回对象:dotNetCompilerObject</a></p>

<p><a id="ComCadObject.NetLoad"></a></p>

<h3>ComCadObject.NetLoad</h3>

<p>加载 .Net DLL。<br>
退出 AutoCAD 进程时自动卸载，没有卸载函数</p>

<p><a id="ComCadObject.NetLoad"></a></p>

<h3>ComCadObject.NetLoad(path,doc)</h3>

<p>加载 .Net DLL，<br>
参数@1指定 *.dll 文件路径，<br>
可选用参数 @2 自定义执行此函数的文档对象</p>

<p><a id="ComCadObject.Path"></a></p>

<h3>ComCadObject.Path</h3>

<p>AutoCAD 安装目录</p>

<p><a id="ComCadObject.PostCommand"></a></p>

<h3>ComCadObject.PostCommand</h3>

<p>异步发送 AutoCAD 命令<br>
<a href="../../../language-reference/templating/syntax.html" tppabs="https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax.html">参数支持 aardio 模板语法</a></p>

<p><a id="ComCadObject.PostCommand"></a></p>

<h3>ComCadObject.PostCommand(cmd,args,doc)</h3>

<p>异步发送 AutoCAD 命令，<br>
参数@1可以是文件、资源文件、LISP 表达式、命令，<br>
每句命令应以空格或回车结束,<br>
尾部的回车可省略  </p>

<p>支持 aardio 模板语法,模板中非数值、布尔值一律转字符串,<br>
一次输出多个模板参数时,字符串自动加引号,多参数自动以空格分开,<br>
可选用 @args 参数指定模板 owner 参数，<br>
可选用参数 @3 自定义执行此函数的文档对象</p>

<p><a id="ComCadObject.Quit"></a></p>

<h3>ComCadObject.Quit()</h3>

<p>退出应用程序</p>

<p><a id="ComCadObject.RunMacro"></a></p>

<h3>ComCadObject.RunMacro()</h3>

<p>运行 VBA 宏，无返回值。<br>
参数 @1 指定宏路径，格式： [Filename.dvb.][ProjectName.][ModuleName.]MacroName<br>
这里的中括号是可选的意思。<br>
Filename.dvb与ProjectName要用感叹号分开，例如 &quot;Filename.dvb!ProjectName&quot;。  </p>

<p>如果没加载 dvb 则会自动加载，如果未指定路径则自动搜索查找文件件。<br>
如果未指定 ProjectName，则在加载项目中查找宏。</p>

<p><a id="ComCadObject.SendCommand"></a></p>

<h3>ComCadObject.SendCommand</h3>

<p>同步发送 AutoCAD 命令<br>
<a href="../../../language-reference/templating/syntax.html" tppabs="https://www.aardio.com/zh-cn/doc/language-reference/templating/syntax.html">参数支持 aardio 模板语法</a></p>

<p><a id="ComCadObject.SendCommand"></a></p>

<h3>ComCadObject.SendCommand(cmd,args,doc)</h3>

<p>同步发送 AutoCAD 命令，<br>
参数@1可以是文件、资源文件、LISP 表达式、命令，<br>
每句命令应以空格或回车结束,<br>
尾部的回车可省略  </p>

<p>支持 aardio 模板语法,模板中非数值、布尔值一律转字符串,<br>
一次输出多个模板参数时,字符串自动加引号,多参数自动以空格分开,<br>
可选用 @args 参数指定模板 owner 参数，<br>
可选用参数 @3 自定义执行此函数的文档对象</p>

<p><a id="ComCadObject.SendCopyData"></a></p>

<h3>ComCadObject.SendCopyData(data,args,dataType)</h3>

<p>用 _WM_COPYDATA 向 AutoCAD 窗口发送数据。<br>
@data 为 需要发送的字符串，发送命令时支持模板语法，<br>
@args 发送命令时，可选用这个参数指定@data 使用的模板参数，<br>
@dataType 省略时默认值为1，为 1 表示发送到 AutoCAD 命令窗口并执行该命令。<br>
发送成功返回1，否则返回0</p>

<p><a id="ComCadObject.ShowForeground"></a></p>

<h3>ComCadObject.ShowForeground()</h3>

<p>前置并显示 AutoCAD 窗口。</p>

<p><a id="ComCadObject.UnloadARX"></a></p>

<h3>ComCadObject.UnloadARX()</h3>

<p>卸载参数@1指定的 ARX 应用程序</p>

<p><a id="ComCadObject.UnloadDVB"></a></p>

<h3>ComCadObject.UnloadDVB()</h3>

<p>卸载 .dvb 工程，无返回值。<br>
参数 @1 指定 .dvb 工程文件路径。</p>

<p><a id="ComCadObject.VersionString"></a></p>

<h3>ComCadObject.VersionString()</h3>

<p>AutoCAD 版本号，字符串值。<br>
例如 AutoCAD 2022 版本号为 &quot;24.1s (LMS Tech)&quot;。<br>
可用 fsys.version 解析与比对版本号。</p>

<p><a id="ComCadObject.Visible"></a></p>

<h3>ComCadObject.Visible</h3>

<p>是否显示 AutoCAD 窗口。<br>
此值建议设置为 true 以显示窗口，<br>
不显示窗口有些功能可能用不了。</p>

<p><a id="ComCadObject.vbaEnabled"></a></p>

<h3>ComCadObject.vbaEnabled()</h3>

<p>是否启用 VBA 。</p>

<p><a id="ComCadObject.Documents"></a></p>

<h2>ComCadObject.Documents 成员列表</h2>

<p>当前文档数组,不显示窗口可能为 null。<br>
这是通过 COM 接口访问的类数组对象，起始下标为 Documents[0] 而不是 Documents[1]，<br>
只能使用 Count 获取数组长度，不能用 # 操作符获取数组长度</p>

<p><a id="ComCadObject.Documents.?"></a></p>

<h3>ComCadObject.Documents.?</h3>

<p><a href="#ComCadDocObject">返回对象:ComCadDocObject</a></p>

<p><a id="ComCadObject.Documents.Add"></a></p>

<h3>ComCadObject.Documents.Add()</h3>

<p>文加文档，返回文档对象  </p>

<p><a href="#ComCadDocObject">返回对象:ComCadDocObject</a></p>

<p><a id="ComCadObject.Documents.Count"></a></p>

<h3>ComCadObject.Documents.Count</h3>

<p>打开文档总数</p>

<p><a id="ComCadObject.Documents.Open"></a></p>

<h3>ComCadObject.Documents.Open()</h3>

<p><a href="#ComCadDocObject">返回对象:ComCadDocObject</a></p>

<p><a id="ComCadObject.Documents.Open"></a></p>

<h3>ComCadObject.Documents.Open(fileame,readOnly,password)</h3>

<p>打开文件，返回文档对象。<br>
@filename 指定文件路径，建议用 io.fullpath 转换为完整路径。<br>
可选参数 @readOnly 指定是否以只读模式打开。<br>
可选用参数 @password 指定密码</p>

<p><a id="ComCadObject.TextStyles"></a></p>

<h2>ComCadObject.TextStyles 成员列表</h2>

<p>文本样式集合。</p>

<p><a id="ComCadObject.TextStyles.Count"></a></p>

<h3>ComCadObject.TextStyles.Count</h3>

<p>文本样式总数</p>

<p><a id="ComCadObject.TextStyles.Item"></a></p>

<h3>ComCadObject.TextStyles.Item()</h3>

<p>获取文本样式，参数  @1 指定索引。</p>

<p><a href="_.md" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/cad/_.md">Markdown 格式</a></p>

</body> 
</html>