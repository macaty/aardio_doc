
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - com.actCtx 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - com.actCtx 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>com.actCtx 库模块帮助文档</h1>

<p><a id="com"></a></p>

<h2>com 成员列表</h2>

<p><a id="com.actCtx"></a></p>

<h3>com.actCtx()</h3>

<p><a href="#ComActCtxObject">返回对象:ComActCtxObject</a></p>

<p><a id="com.actCtx"></a></p>

<h3>com.actCtx(dllPath)</h3>

<p>创建清单加载器,<br>
参数 @1 指定要加载的 DLL 或 OCX 文件路径。</p>

<p><a id="com.actCtx"></a></p>

<h2>com.actCtx 成员列表</h2>

<p>清单加载<br>
请参考调用系统 API 实现清单加载的 raw.activationContext 扩展库</p>

<p><a id="com.actCtx.createDefaultManifest"></a></p>

<h3>com.actCtx.createDefaultManifest</h3>

<p>创建默认清单文件</p>

<p><a id="com.actCtx.createDefaultManifest"></a></p>

<h3>com.actCtx.createDefaultManifest(dllPath)</h3>

<p>自 dllPath 获取首个 COM 类信息，<br>
直接返回包含生成 manifest 数据，<br>
返回数据为 UTF-16 编码的 Unicode 字符串</p>

<p><a id="com.actCtx.createDefaultManifest"></a></p>

<h3>com.actCtx.createDefaultManifest(dllPath,outPath)</h3>

<p>自 dllPath 获取首个 COM 类信息，<br>
生成 UTF-8 编码的 manifest 数据并保存到 @outPath 指定的文件路径</p>

<p><a id="ComActCtxObject"></a></p>

<h2>ComActCtxObject 成员列表</h2>

<p><a id="ComActCtxObject.createDefaultManifest"></a></p>

<h3>ComActCtxObject.createDefaultManifest</h3>

<p>创建默认清单文件</p>

<p><a id="ComActCtxObject.createDefaultManifest"></a></p>

<h3>ComActCtxObject.createDefaultManifest(outPath)</h3>

<p>获取首个 COM 类信息，<br>
生成 UTF-8 编码的 manifest 数据并保存到 @outPath 指定的文件路径<br>
不指定输出路径，则设置默认输入路径为 COM 组件文件名加&quot;.manifest&quot;</p>

<p><a id="ComActCtxObject.createEmbed"></a></p>

<h3>ComActCtxObject.createEmbed</h3>

<p>创建嵌入控件,返回控件容器对象,<br>
容器对象的 _object 成员是创建的 COM 对象,<br>
容器对象可通过添加成员函数响应 COM 对象事件，<br>
容器对象的主要作用是充当访问 COM 对象的中间代理对象。<br>
通常使用 util.metaProperty 为容器对象添加属性元表，<br>
属性元表可拦截属性、函数调用并调用 _object 对象,  </p>

<p>createEmbedEx 返回的容器已添加默认代理以直接访问 COM 对象</p>

<p><a id="ComActCtxObject.createEmbed"></a></p>

<h3>ComActCtxObject.createEmbed()</h3>

<p><a href="_.html#embedObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/_.html#embedObject">返回对象:embedObject</a></p>

<p><a id="ComActCtxObject.createEmbed"></a></p>

<h3>ComActCtxObject.createEmbed(winform,clsId,embedObj)</h3>

<p>创建嵌入控件,返回控件容器对象,<br>
容器对象的 _object 成员是创建的 COM 对象,<br>
容器对象可通过添加成员函数响应 COM 对象事件，<br>
容器对象的主要作用是充当访问 COM 对象的中间代理对象,<br>
@clsId 指定控件 CLSID,如果控件不是自内存加载,<br>
则可省略 @clsId 并由 firstCoClassId函数自动获取,<br>
可选在参数@3 中指定 COM 对象绑定的容器对象</p>

<p><a id="ComActCtxObject.createEmbedEx"></a></p>

<h3>ComActCtxObject.createEmbedEx</h3>

<p>创建嵌入控件,返回控件容器对象,<br>
容器对象的 _object 成员是创建的 COM 对象,<br>
容器对象可通过添加成员函数响应 COM 对象事件，<br>
容器对象的主要作用是充当访问 COM 对象的中间代理对象。<br>
此函数返回的容器已添加元表并创建代理以直接访问 COM 对象</p>

<p><a id="ComActCtxObject.createEmbedEx"></a></p>

<h3>ComActCtxObject.createEmbedEx()</h3>

<p><a href="_.html#embedObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/_.html#embedObject">返回对象:embedObject</a></p>

<p><a id="ComActCtxObject.createEmbedEx"></a></p>

<h3>ComActCtxObject.createEmbedEx(winform,clsId,embedObj)</h3>

<p>创建嵌入控件,返回控件容器对象,<br>
此函数返回的容器已添加元表并创建代理以直接访问 COM 对象,<br>
@clsId 指定控件 CLSID,如果控件不是自内存加载,<br>
则可省略 @clsId 并由 firstCoClassId函数自动获取,<br>
可选在参数@3 中指定 COM 对象绑定的容器对象</p>

<p><a id="ComActCtxObject.createObject"></a></p>

<h3>ComActCtxObject.createObject</h3>

<p>创建对象</p>

<p><a id="ComActCtxObject.createObject"></a></p>

<h3>ComActCtxObject.createObject(progId)</h3>

<p>创建对象，参数@1指定 ProgID</p>

<p><a id="ComActCtxObject.firstCoClassId"></a></p>

<h3>ComActCtxObject.firstCoClassId()</h3>

<p>获取控件的首个 CLSID,<br>
通过内存加载控件时此函数不可用</p>

<p><a id="ComActCtxObject.getObject"></a></p>

<h3>ComActCtxObject.getObject</h3>

<p>获取现有对象实例</p>

<p><a id="ComActCtxObject.getObject"></a></p>

<h3>ComActCtxObject.getObject(progId)</h3>

<p>获取现有对象实例，参数@1指定 ProgID</p>

<p><a id="ComActCtxObject.manifest"></a></p>

<h3>ComActCtxObject.manifest</h3>

<p>指定清单文件路径</p>

<p><a href="actCtx.md" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/com/actCtx.md">Markdown 格式</a></p>

</body> 
</html>