
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言文档 - process.popen 库模块帮助文档'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言文档 - process.popen 库模块帮助文档</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>process.popen 库模块帮助文档</h1>

<p><details>  <summary>相关范例</summary>  <p>
<a href="https://www.aardio.com/zh-cn/doc/example/Process/Pipe/QuickStart.html">范例程序/进程/管道</a>
<a href="https://www.aardio.com/zh-cn/doc/example/Languages/Bat/popen.html">范例程序/调用其他语言/批处理与命令行</a>
<a href="../../example/File/Permissions/cacls.html" tppabs="https://www.aardio.com/zh-cn/doc/example/File/Permissions/cacls.html">范例程序/文件操作/文件权限</a>
</p></details></p>

<p><a id="process"></a></p>

<h2>process 成员列表</h2>

<p><a id="process.popen"></a></p>

<h3>process.popen( ,系统命令行)</h3>

<p>创建可读写的进程管道对象。<br>
如果省略第一个参数,并仅指定命令行,则作为系统命令行启动运行</p>

<p><a id="process.popen"></a></p>

<h3>process.popen()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen"></a></p>

<h3>process.popen(执行文件,命令行参数,startupInfo)</h3>

<p>命令行参数可以是字符串或由多个字符串组成的数组,<br>
数组参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号,<br>
命令参数最大长度为 32765 个字符。<br>
STARTUPINFO参数为 process.STARTUPINFO 结构体,可选参数<br>
如果该参数是普通 table 对象.将自动转换为 STARTUPINFO 结构体。<br>
//@startupInfo 指定{ showWindow = 1/*_SW_NORMAL*/ } 可显示控制台以外的窗口</p>

<p><a id="process.popen"></a></p>

<h3>process.popen(执行文件,命令行参数,更多命令行参数,...)</h3>

<p>命令行参数可以是一个数组、一个或多个字符串参数,  </p>

<p>数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号,<br>
命令参数最大长度为 32765 个字符</p>

<p><a id="process.popen"></a></p>

<h2>process.popen 成员列表</h2>

<p>创建进程管道并调用目标程序，<br>
可隐藏子进程的控制台黑窗口。  </p>

<p>成功返回可读写的进程管道对象，<br>
失败返回 3 个值：null,错误信息,错误代码</p>

<p>创建进程管道并调用目标程序，<br>
可隐藏子进程的控制台黑窗口。  </p>

<p>成功返回可读写的进程管道对象，<br>
失败返回 3 个值：null,错误信息,错误代码。  </p>

<p>个别系统 64 位程序，需要改用 process.popen.wow64 以避免目录重定向。</p>

<p><a id="process.popen.bind64"></a></p>

<h3>process.popen.bind64</h3>

<p>禁用 64 位重定向绑定并返回执行命令行的函数，<br>
该函数的命令行参数可以是一个数组、一个或多个字符串参数,<br>
数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.bind64"></a></p>

<h3>process.popen.bind64(fileName,codepage)</h3>

<p>fileName 指定要执行的命令文件名，<br>
可选用 codepage 参数指定代码页，默认为 0（ANSI）。</p>

<p><a id="process.popen.cmd"></a></p>

<h3>process.popen.cmd</h3>

<p>创建管道按命令行方式调用控制台类型应用程序,<br>
可隐藏子进程的控制台黑窗口,并支持管道读写。</p>

<p><a id="process.popen.cmd"></a></p>

<h3>process.popen.cmd()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.cmd"></a></p>

<h3>process.popen.cmd(命令行参数,...)</h3>

<p>如果第一个参数包含换行,则替换为批处理命令分隔符&amp;,<br>
如果传入多个命令行参数，或者命令行参数是个数组，则合并为单个命令行,<br>
合并时不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.cmd64"></a></p>

<h3>process.popen.cmd64</h3>

<p>创建管道按命令行方式调用控制台类型应用程序,<br>
可隐藏子进程的控制台黑窗口,并支持管道读写。  </p>

<p>此函数禁用64位系统文件与注册表重定向,<br>
在64位系统会返回64位进程,兼容32位系统。  </p>

<p>如果不需要读写管道，应当改用 process.wow64</p>

<p><a id="process.popen.cmd64"></a></p>

<h3>process.popen.cmd64()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.cmd64"></a></p>

<h3>process.popen.cmd64(命令行参数,...)</h3>

<p>如果第一个命令行参数包含换行,则替换为批处理命令分隔符&amp;,<br>
如果传入多个命令行参数，或者命令行参数是个数组，则合并为单个命令行,<br>
合并时不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.detached"></a></p>

<h3>process.popen.detached()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.is"></a></p>

<h3>process.popen.is()</h3>

<p>传入参数是否 process.popen 对象</p>

<p><a id="process.popen.ps"></a></p>

<h3>process.popen.ps()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.ps"></a></p>

<h3>process.popen.ps(<code>-Command</code>,<code>&amp;{}</code>)</h3>

<pre><code class="aardio language-aardio">process.popen.ps(`-Command`,`&amp;{/*请输入要执行的 PowerShell 语句，  
返回 process.popen 进程管道对象。 */}`)
</code></pre>

<p><a id="process.popen.ps"></a></p>

<h3>process.popen.ps(命令行参数,...)</h3>

<p>创建进程执行 PowerShell 命令,返回可读写进程管道,<br>
命令行参数可以是一个数组、一个或多个字符串参数,<br>
数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.ps1("></a></p>

<h3>process.popen.ps1((ps1脚本路径,...)</h3>

<p>创建进程执行 PowerShell *.ps1 脚本,返回可读写进程管道,<br>
可添加一个或多个其他命令行参数,<br>
所有命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.ps1"></a></p>

<h3>process.popen.ps1()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.win"></a></p>

<h3>process.popen.win</h3>

<p>创建进程管道调用目标程序。<br>
隐藏控制台窗口，但允许显示其他图形界面。  </p>

<p>成功返回可读写的进程管道对象（process.popen 对象），<br>
失败返回 3 个值：null,错误信息,错误代码。</p>

<p><a id="process.popen.win"></a></p>

<h3>process.popen.win()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.win"></a></p>

<h3>process.popen.win(执行文件,命令行参数,...)</h3>

<p>命令行参数可以是一个数组、一个或多个字符串参数,  </p>

<p>数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号,<br>
命令参数最大长度为 32765 个字符。</p>

<p><a id="process.popen.wow64"></a></p>

<h3>process.popen.wow64()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.wow64"></a></p>

<h3>process.popen.wow64(执行文件,命令行参数,...)</h3>

<p>创建子进程,返回可读写进程管道,<br>
此函数禁用64位系统文件与注册表重定向,<br>
在64位系统会返回64位进程,兼容32位系统,<br>
命令行参数可以是一个数组、一个或多个字符串参数,  </p>

<p>数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="process.popen.wsl"></a></p>

<h3>process.popen.wsl()</h3>

<p><a href="popen.html#processPopenObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.html#processPopenObject">返回对象:processPopenObject</a></p>

<p><a id="process.popen.wsl"></a></p>

<h3>process.popen.wsl(命令行参数,...)</h3>

<p>创建进程执行 WSL 命令,并支持管道读写,<br>
命令行参数可以是一个数组、一个或多个字符串参数,<br>
数组或多个命令行参数调用 process.joinArguments 合并,<br>
不在双引号内、且包含空白或需要转义的参数转义处理后首尾添加双引号</p>

<p><a id="processPopenObject"></a></p>

<h2>processPopenObject 成员列表</h2>

<p><a id="processPopenObject.assignToJobObject"></a></p>

<h3>processPopenObject.assignToJobObject(process.job.limitKill)</h3>

<p>绑定到作业对象,成功返回 true<br>
作业对象示例请参考标准库 process.job.limitKill 的源码。<br>
也可直接调用 killOnExit 函数绑定 process.job.limitKill</p>

<p><a id="processPopenObject.beforeClose"></a></p>

<h3>processPopenObject.beforeClose</h3>

<pre><code class="aardio language-aardio">processPopenObject.beforeClose = function(){
    owner.process.terminate();/*释放管道以前触发此事件,可强制关闭进程*/
}
</code></pre>

<p><a id="processPopenObject.close"></a></p>

<h3>processPopenObject.close()</h3>

<p>关闭当前对象，释放读写管道。<br>
当前对象释放时会自动调用此函数。<br>
readAll,terminate 等函数会自动调用此函数  </p>

<p>注意此函数并不会关闭目标进程。</p>

<p><a id="processPopenObject.closeMainWindow"></a></p>

<h3>processPopenObject.closeMainWindow()</h3>

<p>关闭进程的主窗口，忽略隐藏窗口</p>

<p><a id="processPopenObject.codepage"></a></p>

<h3>processPopenObject.codepage</h3>

<p>进程输入输出使用的代码页,默认为 0（系统默认 ANSI 编码）。<br>
UTF-8 编码的程序必须指定为 65001 ，否则可能会出现乱码。  </p>

<p>传统命令行程序通常使用 ANSI 编码。<br>
而一些跨平台的语言编写的命令行程序通常会使用 UTF-8 编码。</p>

<p><a id="processPopenObject.ctrlEvent"></a></p>

<h3>processPopenObject.ctrlEvent(0)</h3>

<p>发送 Ctrl+C（SIGINT信号）<br>
信号将传递到与目标进程控制台连接的所有非分离控制台进程<br>
64位目标进程会导致当前控制台暂时关闭</p>

<p><a id="processPopenObject.ctrlEvent"></a></p>

<h3>processPopenObject.ctrlEvent(1)</h3>

<p>发送 Ctrl+Break（SIGINT信号）<br>
信号将传递到与目标进程控制台连接的所有非分离控制台进程<br>
64位目标进程会导致当前控制台暂时关闭</p>

<p><a id="processPopenObject.each"></a></p>

<h3>processPopenObject.each( 间隔时间,超时时间 )</h3>

<pre><code class="aardio language-aardio">for( all,out,err in processPopenObject.each() ){
    io.stdout.write( out,err );/*读取进程输出直到进程关闭，不阻塞界面线程消息*/
}
</code></pre>

<p><a id="processPopenObject.expect"></a></p>

<h3>processPopenObject.expect</h3>

<p>等待直到模式匹配标准输出成功，返回匹配结果。<br>
如果遇到错误输出返回null以及错误信息。<br>
此函数不阻塞界面线程消息</p>

<p><a id="processPopenObject.expect"></a></p>

<h3>processPopenObject.expect(&quot;模式串&quot;,超时,文本最大长度)</h3>

<p>超时参数是以毫秒为单位的估算值，可省略。<br>
参数@3可省略，默认为1024</p>

<p><a id="processPopenObject.expect2"></a></p>

<h3>processPopenObject.expect2</h3>

<p>等待直到模式匹配标准输出成功，返回匹配结果。<br>
注意 expect2 函数会匹配标准输出与错误输出，<br>
而不是像 expect 函数那样遇到错误输出会返回 null。</p>

<p><a id="processPopenObject.expect2"></a></p>

<h3>processPopenObject.expect2(&quot;模式串&quot;,超时,文本最大长度)</h3>

<p>超时参数是以毫秒为单位的估算值，可省略。<br>
参数@3可省略，默认为1024</p>

<p><a id="processPopenObject.getExitCode"></a></p>

<h3>processPopenObject.getExitCode()</h3>

<p>该函数调用成功有两个返回值:进程退出代码,进程是否已退出</p>

<p><a id="processPopenObject.getMainWindow"></a></p>

<h3>processPopenObject.getMainWindow()</h3>

<p>返回进程的主窗口以及窗口进程 ID，找不到则搜寻子进程主窗口。<br>
查找时忽略隐藏窗口。</p>

<p><a id="processPopenObject.getMainWindow"></a></p>

<h3>processPopenObject.getMainWindow(类名,标题)</h3>

<p>返回进程的指定类名的主窗口以及窗口进程 ID，找不到则搜寻子进程主窗口。<br>
类名与标题支持完全匹配与模式匹配，忽略大小写。<br>
所有参数可选，不指定类名或标题时忽略隐藏窗口。</p>

<p><a id="processPopenObject.json"></a></p>

<h3>processPopenObject.json()</h3>

<p>等待并读取进程输出的一行 JSON ，并解析为对象。<br>
成功返回对象，失败返回 null,错误信息。<br>
此函数不阻塞界面线程消息。  </p>

<p>JSON 最外层必须是大括号 {} 或中括号 []，JSON不能包含非转义换行，且必须以换行结束。<br>
自动忽略不符合要求的其他输出。  </p>

<p>使用此函数前必须导入 web.json 库，<br>
注意 process.popen 并不导入 web.json</p>

<p><a id="processPopenObject.jsonAll"></a></p>

<h3>processPopenObject.jsonAll()</h3>

<p>读取进程的全部输出，并用 JSON 解析为 aardio 对象。<br>
成功返回对象，失败返回 null,错误信息。<br>
此函数会等待进程结束，但不会阻塞当前线程窗口消息。  </p>

<p>进程输出应符合 JSON 语法。<br>
如果参数 @1 为 true 或省略，读取后关闭进程管道。  </p>

<p>使用此函数前必须导入 web.json 库，<br>
注意 process.popen 并不导入 web.json</p>

<p><a id="processPopenObject.jsonWrite"></a></p>

<h3>processPopenObject.jsonWrite()</h3>

<p>将对象转换为 JSON 并写入进程标准输入，<br>
JSON 不包含换行，且以换行结尾。<br>
最好统一为输入对象生成的JSON 最外层是大括号 {} 或中括号 []  </p>

<p>使用此函数前必须导入 web.json 库，<br>
注意 process.popen 并不导入 web.json  </p>

<p>成功返回 true，失败返回 null ，错误代码，错误信息。</p>

<p><a id="processPopenObject.killOnExit"></a></p>

<h3>processPopenObject.killOnExit()</h3>

<p>主进程退出时自动退出此进程</p>

<p><a id="processPopenObject.lines"></a></p>

<h3>processPopenObject.lines(模式串,允许处理窗口消息)</h3>

<pre><code class="aardio language-aardio">for i,k,v in processPopenObject.lines(&quot;^(\s*)(\S.*?)[\s.]*\:\s*(.*)&quot;){
    /*按行读取进程输出,移除每行尾部的空白字符,  
指定模式串则返回匹配结果，否则直接返回当前读取的文本。  
如果模式匹配用圆括号创建捕获分组，则每个捕获分组对应一个返回值。  

以上示例模式串匹配用 : 号分隔键值对的行，  
其中 \s 匹配空白字符，大写的 \S 匹配非空白字符  

如果参数 @2 为 true 则读取进程输出时不会阻塞窗口消息*/
}
</code></pre>

<p><a id="processPopenObject.logResponse"></a></p>

<h3>processPopenObject.logResponse</h3>

<p>回显进程的标准输出以及错误输出</p>

<p><a id="processPopenObject.logResponse"></a></p>

<h3>processPopenObject.logResponse(回显函数,间隔时间)</h3>

<p>自动同动获取进程输出,并直到进程结束,所有参数可省略。  </p>

<p>回显函数有 3 个回调参数 all,out,err。<br>
all 为所有输出,out 为标准输出，err 为错误输出。<br>
可用 #err 判断是否出错。  </p>

<p>如果不指定回显函数，且之前定义了 logger 属性，则调用 logger 对象输出进程回显。<br>
未指定 logger 对象则默认回显到控制台。<br>
此函数不会自动打开控制台</p>

<p><a id="processPopenObject.logResponse"></a></p>

<h3>processPopenObject.logResponse(异步回显文本框,间隔时间)</h3>

<p>不会阻塞并等待进程结束,<br>
而是在传入文本框控件上创建定时器异步回显进程输出,<br>
回显文本框必须指定edit或richedit控件,间隔时间可省略。  </p>

<p>如果正在进行异步回显，则调用 waitOne 函数不会读取任何输出。<br>
并且 waitOne 函数会等待异步回显结束</p>

<p><a id="processPopenObject.logger"></a></p>

<h3>processPopenObject.logger</h3>

<p>指定 logResponse 的默认回显对象<br>
该对象必须有log或write成员函数用于输出回显<br>
logger 对象用于logResponse 时将同步获取输出并等待进程结束  </p>

<p>如果不指定此属性,且已导入 console 则默认输出到控制台</p>

<p><a id="processPopenObject.ndjsonAll"></a></p>

<h3>processPopenObject.ndjsonAll()</h3>

<p>读取进程的全部输出，并将多行 JSON 解析为 aardio 对象。<br>
有效的 JSON 必须是JSON 对象或数组，忽略其他 JSON 类型或无效的行。<br>
成功返回对象，失败返回 null,错误信息。<br>
此函数会等待进程结束，但不会阻塞当前线程窗口消息。<br>
如果参数 @1 为 true 或省略，读取后关闭进程管道。  </p>

<p>使用此函数前必须导入 web.json 库，<br>
注意 process.popen 并不导入 web.json</p>

<p><a id="processPopenObject.onResponseEnd"></a></p>

<h3>processPopenObject.onResponseEnd()</h3>

<pre><code class="aardio language-aardio">processPopenObject.onResponseEnd = function(){
    /*被调用进程结束，异步或同步调用 logResponse 函数结束后触发此回调*/
}
</code></pre>

<p><a id="processPopenObject.peek"></a></p>

<h3>processPopenObject.peek()</h3>

<p>检测标准输出管道中可读取的数据长度。<br>
有数据则读取数据,无数据则返回空值<br>
如果 stderr 中有错误信息,则第二个返回值为错误信息<br>
此函数不会因为等待输入而阻塞<br>
参数可指定等待目标进程执行的延时时间</p>

<p><a id="processPopenObject.peekErr"></a></p>

<h3>processPopenObject.peekErr()</h3>

<p>检测标准错误输出管道中可读取的数据长度。<br>
有数据则读取错误信息,无数据则返回空值<br>
此函数不会因为等待输入而阻塞<br>
参数可指定等待目标进程执行的延时时间</p>

<p><a id="processPopenObject.peekTo"></a></p>

<h3>processPopenObject.peekTo</h3>

<p>读取数据直到数据以指定的字符串结束</p>

<p><a id="processPopenObject.peekTo"></a></p>

<h3>processPopenObject.peekTo(&quot;&gt;&quot;,回显函数,超时)</h3>

<p>读取数据，直到数据以 参数@1 指定的字符串结束。<br>
不阻塞当前线程窗口消息。  </p>

<p>返回标准输出,第二个返回值为错误信息<br>
可选使用参数@2指定回显函数,回显函数有两个参数,分别为标准输出,错误信息<br>
可选用参数@3指定无输出时的超时限制<br>
该函数在进程退出后也会返回</p>

<p><a id="processPopenObject.print"></a></p>

<h3>processPopenObject.print()</h3>

<p>清空标准输出然后写数据<br>
多个参数中间添加空格,尾部添加换行  </p>

<p>成功返回 true，失败返回 null ，错误代码，错误信息。</p>

<p><a id="processPopenObject.printf"></a></p>

<h3>processPopenObject.printf()</h3>

<p>清空标准输出然后写数据<br>
调用string.format函数格式化全部参数,尾部添加换行  </p>

<p>成功返回 true，失败返回 null ，错误代码，错误信息。</p>

<p><a id="processPopenObject.process"></a></p>

<h3>processPopenObject.process</h3>

<p><a href="_.html#processObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/process/_.html#processObject">返回对象:processObject</a></p>

<p><a id="processPopenObject.reaUtf8"></a></p>

<h3>processPopenObject.reaUtf8()</h3>

<p>所有参数用法与 read 函数相同。<br>
此函数直接读入，不作任何编码转换。</p>

<p><a id="processPopenObject.read"></a></p>

<h3>processPopenObject.read(&quot;%d&quot;)</h3>

<p>从当前位置,向后读取下一个数值<br>
支持多参数</p>

<p><a id="processPopenObject.read"></a></p>

<h3>processPopenObject.read(&quot;%s&quot;)</h3>

<p>从当前位置,向后读取下一行<br>
支持多参数</p>

<p><a id="processPopenObject.read"></a></p>

<h3>processPopenObject.read()</h3>

<p>正数参数表示从当前位置向后读取n个字节，<br>
支持多参数。</p>

<p>从当前位置,向后读取下一行<br>
默认为二进制模式,行尾可能有回车符号,<br>
可使用 textMode 函数修改</p>

<p><a id="processPopenObject.read"></a></p>

<h3>processPopenObject.read(-1)</h3>

<p>向后读取到文件尾部<br>
负数表示从文件尾部倒计数位置<br>
如果第一个参数为-1，则自动调用 writeClose 关闭输出流,<br>
支持多参数</p>

<p><a id="processPopenObject.read"></a></p>

<h3>processPopenObject.read(0)</h3>

<p>检测是否读取到文件尾</p>

<p><a id="processPopenObject.readAll"></a></p>

<h3>processPopenObject.readAll</h3>

<p>关闭进程输入，并读取所有输出。<br>
返回值 1 包含标准输出与错误输出。<br>
不阻塞当前线程窗口消息</p>

<p><a id="processPopenObject.readAll"></a></p>

<h3>processPopenObject.readAll(匹配模式串,是否关闭)</h3>

<p>读取所有输出,所有参数可选。<br>
返回值 1 包含标准输出与错误输出。  </p>

<p>不指定参数 @1 时会清除返回值 1 文本首尾的空白字符,<br>
返回值 2 为错误输出（无错为 null），返回值 3 为进程退出代码。<br>
如果有输出文本且指定了参数@1，<br>
则按指定的模式串返回匹配的输出文本，此时无返回值 2、返回值 3。  </p>

<p>参数 @2 指定是否关闭进程对象,默认为 true</p>

<p><a id="processPopenObject.readErr"></a></p>

<h3>processPopenObject.readErr(-1)</h3>

<p>读取所有错误输出</p>

<p><a id="processPopenObject.resume"></a></p>

<h3>processPopenObject.resume()</h3>

<p>恢复运行</p>

<p><a id="processPopenObject.stdErr"></a></p>

<h3>processPopenObject.stdErr</h3>

<p>进程标准错误输出  </p>

<p><a href="../io/_.html#ioFileObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/io/_.html#ioFileObject">返回对象:ioFileObject</a></p>

<p><a id="processPopenObject.stdIn"></a></p>

<h3>processPopenObject.stdIn</h3>

<p>进程标准输入  </p>

<p>waitOne 函数返回 true，或 each ，expect 等函数检测到进程退出，<br>
或readAll 或 read 函数参数为 -1 时<br>
会自动关闭目标进程标准输入管道  </p>

<p><a href="../io/_.html#ioFileObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/io/_.html#ioFileObject">返回对象:ioFileObject</a></p>

<p><a id="processPopenObject.stdOut"></a></p>

<h3>processPopenObject.stdOut</h3>

<p>进程标准输出  </p>

<p><a href="../io/_.html#ioFileObject" tppabs="https://www.aardio.com/zh-cn/doc/library-reference/io/_.html#ioFileObject">返回对象:ioFileObject</a></p>

<p><a id="processPopenObject.stillActive"></a></p>

<h3>processPopenObject.stillActive()</h3>

<p>检查进程是否仍在运行，仍在运行返回 true</p>

<p><a id="processPopenObject.stopLogResponse"></a></p>

<h3>processPopenObject.stopLogResponse()</h3>

<p>清除异步回显文本框的定时器。<br>
关闭进程对象时也会自动清除此定时器</p>

<p><a id="processPopenObject.suspend"></a></p>

<h3>processPopenObject.suspend()</h3>

<p>暂停进程</p>

<p><a id="processPopenObject.terminate"></a></p>

<h3>processPopenObject.terminate()</h3>

<p>强制关闭进程并释放进程对象</p>

<p><a id="processPopenObject.textMode"></a></p>

<h3>processPopenObject.textMode(output,input)</h3>

<p>参数 @output 指定进程输出是否使用文本模式<br>
参数 @input 指定进程输入是否使用文本模式<br>
输入输出默认都是二进制模式  </p>

<p>文本模式下<code>&#39;\x1A&#39;</code>(CTRL+Z),<code>&#39;\0&#39;</code>表示终止文本,<br>
并且读入时自动转换回车换行为换行,<br>
写出时自动转换换行符为回车换行</p>

<p><a id="processPopenObject.wait"></a></p>

<h3>processPopenObject.wait()</h3>

<p>等待进程关闭,可选使用一个毫秒值参数设定超时。<br>
超时或失败返回 null，进程退出则返回值1为true，<br>
返回值2为标准输出，返回值3为错误输出，返回值4为退出代码  </p>

<p>如被调用进程写满输出缓冲区，而调用进程没有读取，<br>
则被调用进程会一直等待，此函数将无法返回。<br>
改用 readAll 函数读取输入可避免该问题。</p>

<p><a id="processPopenObject.waitMainWindow"></a></p>

<h3>processPopenObject.waitMainWindow</h3>

<p>等待并返回进程主窗口以及窗口进程ID。</p>

<p><a id="processPopenObject.waitMainWindow"></a></p>

<h3>processPopenObject.waitMainWindow(类名,等待窗口句柄)</h3>

<p>等待并返回进程主窗口以及窗口进程ID。<br>
所有参数可选。<br>
可选指定要等待的类名，类名支持完全匹配与模式匹配，忽略大小写。<br>
不指定类名时忽略隐藏窗口,<br>
可选指定等待窗口句柄,该窗口关闭时些函数不再等待并直接返回结果</p>

<p><a id="processPopenObject.waitOne"></a></p>

<h3>processPopenObject.waitOne()</h3>

<p>等待进程关闭，不会阻塞当前线程窗口消息。<br>
可用一个毫秒值参数设定超时。  </p>

<p>超时或失败返回 null，进程已退出则返回值1为true，<br>
返回值2为标准输出,返回值3为错误输出,返回值4为退出代码  </p>

<p>如果被调用进程写满输出缓冲区，而调用进程没有读取，<br>
则被调用进程会一直等待，此函数将无法返回。<br>
改用 readAll 函数读取输入可避免该问题。  </p>

<p>注意如果正在调用异步 logResponse 回显到窗口对象。<br>
则 waitOne 函数仅返回单个值，不读取任何输出</p>

<p><a id="processPopenObject.write"></a></p>

<h3>processPopenObject.write()</h3>

<p>写数据,支持一个或多个参数。<br>
成功返回 true，失败返回 null ，错误代码，错误信息。<br>
如果目标进程已关闭，但标准输入管道未释放仍可能返回 true。  </p>

<p>waitOne 函数返回 true，或 each ，expect 等函数检测到进程退出，<br>
或readAll 或 read 函数参数为 -1 时<br>
会自动关闭目标进程标准输入管道<br>
并导致 write 函数返回 null 值</p>

<p><a id="processPopenObject.writeClose"></a></p>

<h3>processPopenObject.writeClose()</h3>

<p>写数据并关闭进程输入流,<br>
可选指定一个或多个参数<br>
不指定参数则直接关闭输入流<br>
注意:有些进程会一直等待输入流关闭再继续下一下操作</p>

<p><a id="processPopenObject.writeUtf8"></a></p>

<h3>processPopenObject.writeUtf8()</h3>

<p>写入 UTF8 编码数据，不作编码转换，支持一个或多个参数。<br>
成功返回 true，失败返回 null ，错误代码，错误信息。<br>
如果目标进程已关闭，但标准输入管道未释放仍可能返回 true。  </p>

<p>waitOne 函数返回 true，或 each ，expect 等函数检测到进程退出，<br>
或readAll 或 read 函数参数为 -1 时<br>
会自动关闭目标进程标准输入管道<br>
并导致 write 函数返回 null 值</p>

<p><a href="https://www.aardio.com/zh-cn/doc/library-reference/process/popen.md">Markdown 格式</a></p>

</body> 
</html>