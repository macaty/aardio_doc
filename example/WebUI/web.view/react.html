
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - è°ƒç”¨ React hooks'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - è°ƒç”¨ React hooks</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - è°ƒç”¨ React hooks</h1><pre><code class="aardio language-aardio">//web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - è°ƒç”¨ React hooks
import sys.device;
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;WebView2&quot;;right=966;bottom=622)
winform.add(
button={cls=&quot;button&quot;;text=&quot;åˆ—å‡ºç³»ç»Ÿ PCI ç¡¬ä»¶è®¾å¤‡&quot;;left=615;top=537;right=869;bottom=606;color=14120960;db=1;dr=1;font=LOGFONT(h=-14);note=&quot;åœ¨ aardio ä¸­è®¾ç½® React ç»„ä»¶æ•°æ®&quot;;z=2};
static={cls=&quot;static&quot;;left=8;top=6;right=956;bottom=503;db=1;dl=1;dr=1;dt=1;z=1}
)
/*}}*/

import web.view;
var wb = web.view(winform.static);

/*
wb.export å¯¼å‡º aardio å‡½æ•°ä¸º Javascript å…¨å±€å¯¹è±¡ï¼ˆ Promise å¯¹è±¡ ï¼‰, 
JavaScript è°ƒç”¨è¿™äº› aardio å‡½æ•°æ—¶å°†ä¼šä½¿ç”¨ JSON è‡ªåŠ¨è½¬æ¢è·¨ç¼–ç¨‹è¯­è¨€çš„å‚æ•°å’Œè¿”å›å€¼ã€‚
è¿™ç§ç»ç”± JSON è½¬æ¢çš„å¯¹è±¡ä¸ JavaScript å®Œå…¨å…¼å®¹ï¼Œä¾‹å¦‚ä¸‹é¢è¿”å›çš„ result å¯ä»¥ç›´æ¥ä½œä¸º JavaScript è¡¨æ ¼çš„æ•°æ®æºä½¿ç”¨ã€‚

è€Œé€šè¿‡ wb.external å¯¼å‡ºçš„ aardio å‡½æ•°åˆ™åªèƒ½è¿”å› COM ä»£ç†å¯¹è±¡ï¼Œè¿”å›çš„ aardio å¯¹è±¡ä¸èƒ½ä½œä¸º JavaScript è¡¨æ ¼çš„æ•°æ®æºä½¿ç”¨ã€‚
*/  
wb.export(
    getData = function(){

        var result = table.array();

        var devInfo = sys.device(,&quot;PCI&quot;);
        for( index,classGuid,deviceDesc 
            in devInfo.each(8/*_SPDRP_CLASSGUID*/,0/*_SPDRP_DEVICEDESC*/) ){
            table.push(result,{classGuid:classGuid,deviceDesc:deviceDesc});
        }

        thread.delay(1000);//æ¨¡æ‹Ÿè€—æ—¶ loading
        return result;
    };
)

wb.html = /**
&lt;!DOCTYPE html&gt;&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot; /&gt;
    &lt;title&gt;WebView2&lt;/title&gt; 
    &lt;script src=&quot;https://lib.baomitu.com/react/18.2.0/umd/react.production.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://lib.baomitu.com/react-dom/18.2.0/umd/react-dom.production.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://lib.baomitu.com/dayjs/1.11.7/dayjs.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://lib.baomitu.com/antd/5.14.1/antd.min.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://lib.baomitu.com/antd/5.14.1/reset.min.css&quot;&gt; 
    &lt;script src=&quot;https://lib.baomitu.com/babel-standalone/7.22.20/babel.min.js&quot;&gt;&lt;/script&gt; 
    &lt;script&gt;!function(e,n){&quot;object&quot;==typeof exports&amp;&amp;&quot;undefined&quot;!=typeof module?module.exports=n():&quot;function&quot;==typeof define&amp;&amp;define.amd?define(n):(e=e||self).mitt=n()}(this,function(){return function(e){return{all:e=e||new Map,on:function(n,t){var f=e.get(n);f?f.push(t):e.set(n,[t])},off:function(n,t){var f=e.get(n);f&amp;&amp;(t?f.splice(f.indexOf(t)&gt;&gt;&gt;0,1):e.set(n,[]))},emit:function(n,t){var f=e.get(n);f&amp;&amp;f.slice().map(function(e){e(t)}),(f=e.get(&quot;*&quot;))&amp;&amp;f.slice().map(function(e){e(n,t)})}}}});
    emitter = mitt();//github.com/developit/mitt &lt;/script&gt;
&lt;/head&gt;
&lt;body&gt;  

&lt;script type=&quot;text/babel&quot;&gt; 
    const { useState,useEffect,useCallback,useRef } =  React;
    const { Button,Table,DatePicker,Alert,Tooltip,Space } = antd;

    const App = () =&gt; { 
            const [data,setData] = useState([]);
            const [loading,setLoading] = useState(false); 

            useEffect(() =&gt; {
                emitter.on(&quot;setData&quot;, setData);  
                emitter.on(&quot;setLoading&quot;, setLoading); 
                return () =&gt;  {
                    emitter.off(&quot;setData&quot;, setData); 
                    emitter.off(&quot;setLoading&quot;, setLoading); 
                }
            },[])


            return ( 
                &lt;div style={{ width: &#39;100%&#39;, margin: &#39;0 auto&#39;, padding:&#39;10px&#39; }}&gt;    
                &lt;Button onClick={ 
                    async ()=&gt; {
                        setData([]);
                        setLoading(true);
                        var ds = await getData();
                        setData(ds);
                        setLoading(false);
                    }
                } loading={loading}&gt;åˆ—å‡ºç³»ç»Ÿ PCI ç¡¬ä»¶è®¾å¤‡&lt;/Button&gt;

                &lt;br/&gt;&lt;br/&gt;

                &lt;Table size=&quot;middle&quot;  
                    sortDirections={[&#39;ascend&#39;, &#39;descend&#39;, &#39;ascend&#39;]} 
                    dataSource={data} 
                    columns={[
                        {
                            title: &#39;GUID&#39;,
                            dataIndex: &#39;classGuid&#39;,
                            width: 300,
                            key: &#39;classGuid&#39;,

                        },
                        {
                            title: &#39;ç¡¬ä»¶è®¾å¤‡&#39;,
                            dataIndex: &#39;deviceDesc&#39;,
                            key: &#39;deviceDesc&#39;,
                            sorter: (a, b) =&gt; a.classGuid &gt; b.classGuid,
                            defaultSortOrder: &#39;descend&#39;,
                        }
                ]} /&gt;

                &lt;/div&gt; 
            );
    };

    const root = ReactDOM.createRoot(document.getElementById(&#39;app&#39;))
    root.render(&lt;App /&gt;); 
&lt;/script&gt;

&lt;div id=&quot;app&quot;&gt;&lt;/div&gt;
&lt;/body&gt; 
**/

//è°ƒç”¨ JS å‡½æ•°
wb.emit = lambda(...) wb.xcall(&quot;emitter.emit&quot;,...);

// aardio æŒ‰é’®äº‹ä»¶
winform.button.oncommand = function(id,event){
    winform.button.disabledText = {&quot;âœ¶&quot;;&quot;âœ¸&quot;;&quot;âœ¹&quot;;&quot;âœº&quot;;&quot;âœ¹&quot;;&quot;âœ·&quot;};

    var result = table.array();

    wb.emit(&quot;setData&quot;,result);
    wb.emit(&quot;setLoading&quot;,true);

    var devInfo = sys.device(,&quot;PCI&quot;);
    for( index,classGuid,deviceDesc 
        in devInfo.each(8/*_SPDRP_CLASSGUID*/,0/*_SPDRP_DEVICEDESC*/) ){
        table.push(result,{classGuid:classGuid,deviceDesc:deviceDesc});
    }

    thread.delay(1000);//æ¨¡æ‹Ÿè€—æ—¶ loading
    wb.emit(&quot;setData&quot;,result);
    wb.emit(&quot;setLoading&quot;,false);

    winform.button.disabledText = null;
}

winform.show();
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/react.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ·ÃÎÊµÄÎÄ¼şÊÇÒş²ØµÄ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/react.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/react.md">Markdown æ ¼å¼</a>
</body> 
</html>