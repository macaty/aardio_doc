
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - å…¥é—¨'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - å…¥é—¨</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - å…¥é—¨</h1><pre><code class="aardio language-aardio">//web.view( WebView2 æµè§ˆå™¨æ§ä»¶) - å…¥é—¨
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;Edge æµè§ˆå™¨æ§ä»¶ - web.view&quot;;right=800;bottom=469;bgcolor=16777215)
winform.add()
/*}}*/

/*
ç½‘é¡µå¼€å‘æ–‡æ¡£æ•™ç¨‹
https://developer.mozilla.org/zh-CN/docs/Web/HTML/Element/html
https://learnxinyminutes.com/docs/zh-cn/javascript-cn
https://learnxinyminutes.com/docs/zh-cn/html-cn
https://learnxinyminutes.com/docs/zh-cn/css-cn
https://quickref.me/javascript
https://quickref.me/es6 https://babeljs.io/docs/en/learn/#ecmascript-2015-features
https://quickref.me/css

web.view å…¥é—¨æ•™ç¨‹ï¼š
https://mp.weixin.qq.com/s/iYXPJgagXax9VgiIYaRfRw
*/
if(!_WIN10_LATER) import web.view.7; //å…¼å®¹ Win7 ä»¥åŠä¹‹åç‰ˆæœ¬ï¼Œä¸æ”¯æŒæ–°ç‰ˆ WebView2 çš„åŠŸèƒ½ã€‚ 
else import web.view;//æ”¯æŒ Win10 ä»¥åŠä¹‹åç‰ˆæœ¬ï¼Œå¯¼å…¥è¿™ä¸ªå°±åˆ«å¯¼å…¥å‰é¢çš„ web.view.7;  

/*
å‚æ•° @1 æŒ‡å®šåµŒå…¥çª—å£ï¼ˆå¯ä»¥æ˜¯ winform æˆ– static,custom ç­‰æ§ä»¶å¯¹è±¡ï¼‰ã€‚
å¯é€‰ç”¨å‚æ•° @2 æŒ‡å®šæµè§ˆå™¨ç”¨æˆ·æ•°æ®ç›®å½•ï¼Œå¯é€‰ç”¨å‚æ•° @3 æŒ‡å®šæµè§ˆå™¨å¯åŠ¨å‚æ•°ã€‚
*/
var wb = web.view(winform);

/*
åœ¨ Javascript ä¸­å¯é€šè¿‡å…¨å±€å˜é‡ `aardio` è®¿é—® wb.external å¯¹è±¡ã€‚
åœ¨ JavaScript ä¸­æ‰€æœ‰çš„ aardio å¯¹è±¡ä»¥åŠ aardio å¯¹è±¡çš„æ–¹æ³•ä¸å±æ€§éƒ½è¢«åŒ…è£…ä¸º Promise å¯¹è±¡

åœ¨ JavaScript ä¸­è°ƒç”¨ wb.external å¯¼å‡ºçš„å‡½æ•°æ—¶ï¼Œå‚æ•°ä¸è¿”å›å€¼éƒ½ä¸éœ€è¦ç»è¿‡ JSON è½¬æ¢ã€‚
é™¤å­—ç¬¦ä¸²ã€æ•°å€¼ã€å¸ƒå°”å€¼ã€å¯å…¼å®¹çš„æ•°ç»„ã€buffer ç­‰åŸºç¡€å€¼ç±»å‹å¯ä»¥ç›´æ¥ä¼ å€¼ä»¥å¤–ï¼Œ
å…¶ä»–å¯¹è±¡ç±»å‹ï¼ˆJavaScript ä¸­çš„ object æˆ– aardio ä¸­çš„è¡¨å¯¹è±¡ ï¼‰è‡ªåŠ¨è½¬æ¢ä¸º COM ä»£ç†å¯¹è±¡ï¼Œ
è®©æˆ‘ä»¬å¯ä»¥é€šè¿‡ COM æ¥å£é—´æ¥æ“ä½œè·¨è¯­è¨€çš„å¯¹è±¡ã€‚

è¦æ³¨æ„ä¸èƒ½å°†è¿™ç§ COM ä»£ç†å¯¹è±¡ä½œä¸ºåŸç”Ÿ JavaScript å¯¹è±¡ä½¿ç”¨ï¼Œ
ä¾‹å¦‚ä¸èƒ½ç”¨äº JavaScript å›¾è¡¨æˆ–è¡¨æ ¼çš„æ•°æ®æºå¯¹è±¡ï¼Œè€Œ wb.export å¯¼å‡ºçš„ aardio å‡½æ•°åˆ™æ— æ­¤é™åˆ¶ã€‚
*/
wb.external = {
    toString = function(){
        return owner.property; 
    };
    property = &quot;è¿™æ˜¯ aardio å¯¹è±¡çš„å±æ€§å€¼&quot;;
    methodWithParametersAndReturnValue = function(a,b){
        return a + b
    } 
    //aardio å‡½æ•°å¦‚æœæŠ›å‡ºå¼‚å¸¸ï¼Œç½‘é¡µ DevTools è°ƒè¯•å·¥å…·å¯æŸ¥çœ‹é”™è¯¯ä¿¡æ¯
}

/*
wb.export å¯¼å‡º aardio å‡½æ•°ä¸º Javascript å…¨å±€å¯¹è±¡ï¼ˆ Promise å¯¹è±¡ ï¼‰, 
JavaScript è°ƒç”¨è¿™äº› aardio å‡½æ•°æ—¶å°†ä¼šä½¿ç”¨ JSON è‡ªåŠ¨è½¬æ¢è·¨ç¼–ç¨‹è¯­è¨€çš„å‚æ•°å’Œè¿”å›å€¼ã€‚
è¿™ç§ç»ç”± JSON è½¬æ¢çš„å¯¹è±¡ä¸ JavaScript å®Œå…¨å…¼å®¹ï¼Œè€Œ wb.external å¯¼å‡ºçš„å‡½æ•°åˆ™åªèƒ½è¿”å› COM ä»£ç†å¯¹è±¡ã€‚

åœ¨è¢«ç½‘é¡µå›è°ƒçš„ aardio å‡½æ•°å†…éƒ¨è°ƒç”¨ wb.eval, wb.xcall å¯èƒ½é˜»å¡åç»­è°ƒç”¨ã€‚
åº”æ”¹ç”¨éé˜»å¡çš„ wb.invoke, wb.doScript ã€‚æˆ–è€…é€šè¿‡ winform.setTimeout å¼‚æ­¥è°ƒç”¨ wb.invoke, wb.doScriptã€‚
*/
wb.export({
    alert = function(msg){
        winform.msgbox(msg) 

        //è¦é¿å…é‡å…¥ï¼Œä¾‹å¦‚ï¼šä¸èƒ½åœ¨ alert å›è°ƒä¸­å†æ¬¡è°ƒç”¨ alert å‡½æ•°
        //wb.invoke(&quot;alet(&#39;test&#39;)&quot;);
    };
    nativeAdd = function(a,b){ 
        return a + b; 
    }
})

/*
å¦‚æœé€šè¿‡ wb.html ç›´æ¥å†™å…¥ HTMLï¼Œåˆ™ä¸èƒ½å¼•ç”¨å…¶ä»–æœ¬åœ°æ–‡ä»¶è·¯å¾„ã€‚
å¦‚æœéœ€è¦å¼•ç”¨ JS,CSS ç­‰æœ¬åœ°èµ„æºæ–‡ä»¶ï¼Œè¯·æ”¹ä¸ºï¼š

import wsock.tcp.simpleHttpServer;
wb.go(&quot;/res/index.html&quot;) 
*/
wb.html = /**
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;style type=&quot;text/css&quot;&gt;
    html,body{ height:100%; } 
    &lt;/style&gt;
    &lt;script type=&quot;text/javascript&quot;&gt; 
    (async ()=&gt;{
        var v = await aardio.property;
        var n = await aardio.methodWithParametersAndReturnValue(21,12);

        /*
        aardio ä½œä¸ºä¸€ä¸ª JavaScript å¯¹è±¡ä¹Ÿæœ‰ä¸€äº›æˆå‘˜æ˜¯ Javascript å‡½æ•°ï¼ˆæˆ–å±æ€§ï¼‰ã€‚
        ä¾‹å¦‚ aardio.toString() è°ƒç”¨çš„å°±æ˜¯ Javascript å‡½æ•°ã€‚

        å¦‚æœè¦è°ƒç”¨åŒåçš„ aardio å‡½æ•°æŒ‰å¾®è½¯çš„æ–‡æ¡£è¦å†™ä¸º aardio.applyHostFunction(&quot;toString&quot;) ï¼Œ
        ä½†å®é™…æµ‹è¯•æ­£ç¡®å†™æ³•åº”è¯¥æ˜¯ aardio.getHostProperty(&quot;toString&quot;).applyHostFunction([])ã€‚
        applyHostFunction å…¶å®å¯ä»¥çœç•¥ï¼Œæ‰€ä»¥å¯ä»¥è¿™æ ·å†™ï¼š
        */
        var str = await aardio.getHostProperty(&quot;toString&quot;)() ;//æ²¡å¿…è¦å–è¿™ç§å‡½æ•°åï¼Œä¹Ÿæ²¡å¿…è¦è¿™æ ·å†™ã€‚

        alert(str);
    })()
    &lt;/script&gt;
&lt;/head&gt;
&lt;body style=&quot;margin:50px&quot;&gt;
web.view åŸºäºå¾®è½¯ WebView2ï¼ˆEdge/Chromiumå†…æ ¸ï¼‰ï¼Œ&lt;br&gt;
WebView2 ç¨³å®šå¯é ã€æ€§èƒ½å¼ºæ‚ã€æ¥å£ç®€æ´ï¼Œå¯ç”Ÿæˆä½“ç§¯å¾ˆå°çš„ç‹¬ç«‹ EXE ç¨‹åºã€‚&lt;br&gt;
&lt;br&gt;
WebView2 æ”¯æŒ Win10 ä»¥åŠä¹‹åçš„ç³»ç»Ÿã€‚&lt;br&gt;
Win11 å·²è‡ªå¸¦ WebView2ï¼ŒWin10 1803 ä»¥åŠä¹‹åçš„ç³»ç»Ÿæ—©å·²è‡ªåŠ¨æ¨é€ WebView2ã€‚&lt;br&gt;
&lt;br&gt;
å®é™…ä¸Šç°åœ¨ WebView2 å·²ç»æ˜¯æ— æ³•å¸è½½çš„ç³»ç»Ÿçº§ç»„ä»¶ã€‚&lt;br&gt;
æ²¡æœ‰è‡ªå¸¦ WebView2 çš„æ—§ç³»ç»Ÿå·²ç»éå¸¸ç½•è§ï¼Œå¯ä»¥å¿½ç•¥ä¸è®°ã€‚&lt;br&gt;
&lt;br&gt;

åªè¦ç®€æ´ï¼Œä¸æ±‚å®Œç¾ï¼&lt;br&gt;
Win7 åœ¨å¸‚åœºä¸Šå·²ç»æ¥è¿‘æ¶ˆå¤±ï¼Œç°åœ¨å¼€å‘è½¯ä»¶å†å¤„å¤„è€ƒè™‘ Win7 å…¼å®¹æ˜¯ä¸å¿…è¦çš„ã€‚&lt;br&gt;
web.view æ”¯æŒåº“ä¸å†æ”¯æŒ Win7ï¼Œå¯é€šè¿‡ web.view.7 æ‰©å±•åº“å¯¼å…¥å…¼å®¹ Win7 çš„æ—§ç‰ˆ web.view ã€‚ 
&lt;br&gt;
åœ¨ç½‘é¡µä¸Šç‚¹å³é”®èœå•é¡¹&lt;b&gt;ï¼ˆInspect / æ£€æŸ¥ï¼‰&lt;/b&gt;æˆ–æŒ‰ F12 é”®å¯ä»¥æ‰“å¼€ç½‘é¡µå¼€å‘å·¥å…·ï¼ˆ DevTools ï¼‰ï¼Œ&lt;br&gt;
åœ¨å¼€å‘å·¥å…·çš„ã€Œè®¾ç½® / è¯­è¨€ã€&lt;b&gt;ï¼ˆSettings / Languageã€ï¼‰&lt;/b&gt;ç•Œé¢å¯åˆ‡æ¢å¼€å‘å·¥å…·çš„ç•Œé¢è¯­è¨€ã€‚&lt;br&gt;
åœ¨ DevTools &lt;b&gt;æ§åˆ¶å°ï¼ˆConsoleï¼‰&lt;/b&gt;å¯æŸ¥çœ‹ç¨‹åºé”™è¯¯ä¿¡æ¯ã€‚&lt;br&gt;
&lt;/body&gt;
&lt;/html&gt;
**/

/*
//æ‰“å¼€è¿œç¨‹ç½‘å€å¯ä»¥è¿™æ ·å†™
wb.go(&quot;https://aardio.com&quot;)

å¦‚æœéœ€è¦æ‰“å¼€åµŒå…¥èµ„æºç›®å½•ä¸‹çš„ç½‘é¡µï¼Œ
éœ€è¦äº‹å…ˆå¯¼å…¥ wsock.tcp.simpleHttpServer æˆ– wsock.tcp.asynHttpServerã€‚

ä¾‹å¦‚ï¼š
import wsock.tcp.simpleHttpServer; 
wb.go(&quot;\res\index.html&quot;); 

è¿™æ—¶å€™ aardio ä¼šè‡ªåŠ¨åˆ›å»ºåµŒå…¥ HTTP æœåŠ¡ç«¯ï¼Œ
å¹¶å°†å•ä¸ªæ–œæ æˆ–åæ–œæ†å¼€å¤´çš„è·¯å¾„è½¬æ¢ä¸ºåµŒå…¥ HTTP æœåŠ¡ç«¯åœ°å€ï¼ˆæ”¯æŒ SPA å•é¡µåº”ç”¨ï¼‰ã€‚
å¦‚æœæ‰“å¼€è·¯å¾„çš„æ–‡ä»¶åä¸º &quot;index.html&quot;, åˆ™ä¸Šçº§ç›®å½•è‡ªåŠ¨è®¾ä¸ºæ ¹ç›®å½•ã€‚
ä¹Ÿå°±æ˜¯è¯´å‰ç«¯å·¥ç¨‹é‡Œä¸ç”¨å†é…ç½®éæ ¹ç›®å½•ï¼Œç½‘é¡µå¯ä»¥ç›´æ¥ä½¿ç”¨  &quot;/index.html&quot; è¿™æ ·çš„è·¯å¾„ã€‚

ä¸Šé¢çš„ä»£ç ç­‰ä»·äºä¸‹é¢çš„ä»£ç ï¼š
import wsock.tcp.simpleHttpServer; 
var indexUrl = wsock.tcp.simpleHttpServer.startSpaUrl(&quot;\res\index.html&quot;,&quot;\res\&quot;);
wb.go(indexUrl); 
*/

//æ‰§è¡Œ JS å¹¶è·å–è¿”å›å€¼ã€‚
wb.doScript(&quot;window.location.href&quot;,function(result,err){
    winform.msgbox(result,&quot;doScript&quot;)
})

winform.show();
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/view.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ·ÃÎÊµÄÎÄ¼şÊÇÒş²ØµÄ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/view.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/WebUI/web.view/view.md">Markdown æ ¼å¼</a>
</body> 
</html>