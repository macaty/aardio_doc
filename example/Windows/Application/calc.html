
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - ç®€å•è®¡ç®—å™¨'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio ç¼–ç¨‹è¯­è¨€èŒƒä¾‹ - ç®€å•è®¡ç®—å™¨</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio ç¼–ç¨‹è¯­è¨€æ–‡æ¡£é¦–é¡µ"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio æ–‡æ¡£</span></a>
<h1>aardio èŒƒä¾‹: ç®€å•è®¡ç®—å™¨</h1><pre><code class="aardio language-aardio">//ç®€å•è®¡ç®—å™¨
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;æˆ‘çš„è®¡ç®—å™¨&quot;;right=299;bottom=207;border=&quot;dialog frame&quot;;max=false)
winform.add(
button0={cls=&quot;button&quot;;text=&quot;0&quot;;left=34;top=158;right=110;bottom=182;z=12};
button1={cls=&quot;button&quot;;text=&quot;1&quot;;left=34;top=56;right=65;bottom=80;z=3};
button2={cls=&quot;button&quot;;text=&quot;2&quot;;left=79;top=56;right=110;bottom=80;z=5};
button3={cls=&quot;button&quot;;text=&quot;3&quot;;left=128;top=56;right=159;bottom=80;z=8};
button4={cls=&quot;button&quot;;text=&quot;4&quot;;left=34;top=89;right=65;bottom=113;z=4};
button5={cls=&quot;button&quot;;text=&quot;5&quot;;left=79;top=89;right=110;bottom=113;z=7};
button6={cls=&quot;button&quot;;text=&quot;6&quot;;left=128;top=89;right=159;bottom=113;z=11};
button7={cls=&quot;button&quot;;text=&quot;7&quot;;left=34;top=122;right=65;bottom=146;z=6};
button8={cls=&quot;button&quot;;text=&quot;8&quot;;left=79;top=122;right=110;bottom=146;z=10};
button9={cls=&quot;button&quot;;text=&quot;9&quot;;left=128;top=122;right=159;bottom=146;z=9};
buttonAdd={cls=&quot;button&quot;;text=&quot;+&quot;;left=179;top=56;right=210;bottom=80;z=14};
buttonClear={cls=&quot;button&quot;;text=&quot;C&quot;;left=225;top=56;right=256;bottom=80;z=18};
buttonClearError={cls=&quot;button&quot;;text=&quot;CE&quot;;left=226;top=88;right=257;bottom=112;z=19};
buttonDiv={cls=&quot;button&quot;;text=&quot;/&quot;;left=180;top=156;right=211;bottom=182;z=16};
buttonDot={cls=&quot;button&quot;;text=&quot;.&quot;;left=129;top=158;right=159;bottom=182;z=17};
buttonEval={cls=&quot;button&quot;;text=&quot;=&quot;;left=226;top=122;right=257;bottom=182;z=1};
buttonMul={cls=&quot;button&quot;;text=&quot;*&quot;;left=179;top=122;right=210;bottom=146;z=15};
buttonSub={cls=&quot;button&quot;;text=&quot;-&quot;;left=179;top=89;right=210;bottom=113;z=13};
edit={cls=&quot;edit&quot;;text=&quot;0&quot;;left=35;top=24;right=256;bottom=49;edge=1;z=2}
)
/*}}*/

//è®¡ç®—å‡½æ•°ï¼ˆæ”¯æŒåœ¨æ–‡æœ¬æ¡†ä¸­ç›´æ¥è¾“å…¥ç®—å¼ï¼‰
var calc = function(){
    try{

        //å¦‚æœæ–‡æœ¬æ¡†å½“å‰ä¸æ˜¯æ˜¾ç¤ºç»“æœ,è€Œæ˜¯è¾“å…¥æ•°å€¼æˆ–è¡¨è¾¾å¼çŠ¶æ€
        if( winform.edit.state = &quot;expression&quot; ) {

            //å¦‚æœä¹‹å‰æŒ‰äº†å…¶ä»–æ“ä½œç¬¦ï¼Œå…ˆè·Ÿä»¥å‰çš„æ“ä½œç¬¦è®¡ç®—å‡ºç»“æœ
            if( winform.edit.operator ){
                winform.edit.result = eval( ..string.format(&quot;%f %s (%s)&quot;, winform.edit.result, winform.edit.operator, winform.edit.text) );
                winform.edit.operator = null; //è¯¥æ“ä½œç¬¦å·²ç»è¿‡è¿ç®—,ä¿ç•™ç»“æœ,ä¸¢å¼ƒè¯¥è¿ç®—ç¬¦
            }
            else {
                winform.edit.result = eval(winform.edit.text)
            }

            winform.edit.text = string.format(&quot;%g&quot;, winform.edit.result);//æ˜¾ç¤ºç»“æœ
            winform.edit.state = &quot;result&quot;; //æ–‡æœ¬æ¡†è¿›å…¥æ˜¾ç¤ºç»“æœçŠ¶æ€

            if( winform.edit.result == 1/0 ){
                winform.edit.text = &quot;æ— ç©·å¤§&quot;
                for(name,ctrl in winform.eachControl(&quot;button&quot;) ) ctrl.disabled = true;
                winform.buttonClear.disabled = false;
            }
            elseif( winform.edit.result == -1/0 ){
                winform.edit.text = &quot;è´Ÿæ— ç©·å¤§&quot;
                for(name,ctrl in winform.eachControl(&quot;button&quot;) ) ctrl.disabled = true;
                winform.buttonClear.disabled = false;
            }
            elseif( !(winform.edit.result==winform.edit.result) ){ 
                winform.edit.text = &quot;æ— æ•ˆæ•°å€¼&quot; // 0/0 -1.#IND
                for(name,ctrl in winform.eachControl(&quot;button&quot;) ) ctrl.disabled = true;
                winform.buttonClear.disabled = false;
            }
        }

        winform.edit.setFocus();
    }
    catch(e){
        winform.edit.showErrorTip(winform.text,&quot;è¯·è¾“å…¥æ­£ç¡®çš„æ•°å€¼æˆ–è¡¨è¾¾å¼&quot;);
        winform.edit.setFocus(0,-1);
    }
}

//éå†æ‰€æœ‰ç±»åä¸º&quot;button&quot;çš„æ§ä»¶(å®é™…ä¸Šæ˜¯ä¸ºäº†æŒ‡å®šæ‰€æœ‰æ•°å­—é”®çš„äº‹ä»¶)
for(name,ctrl in winform.eachControl(&quot;button&quot;) ){
    ctrl.oncommand = function(id,event){
        //å¦‚æœå½“å‰æ˜¯è¾“å…¥è¡¨è¾¾å¼ï¼ˆæˆ–æ•°å€¼ï¼‰çŠ¶æ€
        if( winform.edit.state = &quot;expression&quot; ){
            if( ctrl.text==&quot;.&quot; &amp;&amp; string.indexOf(winform.edit.text,&quot;.&quot;) ){
                winform.edit.showErrorTip(winform.text,&quot;æ•°å€¼ä¸èƒ½åŒ…å«å¤šä¸ªå°æ•°ç‚¹&quot;)
                return;
            }

            winform.edit.appendText(ctrl.text); //è¿½åŠ æ•°å€¼
        }
        else {
            if(ctrl.text==&quot;.&quot; &amp;&amp; winform.edit.text==&quot;0&quot;){
                winform.edit.appendText(ctrl.text); 
            }
            else {
                winform.edit.text = ctrl.text;
            }

            winform.edit.state = &quot;expression&quot;
        }

        winform.edit.setFocus();
    }
}

//å¦‚æœç”¨æˆ·æ‰‹åŠ¨è¾“å…¥è¡¨è¾¾å¼è¿™äº›,é‚£å°±è¯´æ˜å½“å‰ä¸æ˜¯æ˜¾ç¤ºç»“æœçŠ¶æ€äº†
winform.edit.oncommand = function(id,event){
    if( event == 0x300/*_EN_CHANGE*/ ){
        winform.edit.state = &quot;expression&quot;;
    }
}

//åŠ 
winform.buttonAdd.oncommand = function(id,event){
    calc();
    winform.edit.operator = &quot;+&quot; 
}

//å‡
winform.buttonSub.oncommand = function(id,event){
    calc();
    winform.edit.operator = &quot;-&quot; 
}

//ä¹˜
winform.buttonMul.oncommand = function(id,event){
    calc();
    winform.edit.operator = &quot;*&quot; 
}

//é™¤
winform.buttonDiv.oncommand = function(id,event){
    calc();
    winform.edit.operator = &quot;/&quot; 
}

//ç­‰äº
winform.buttonEval.oncommand = function(id,event){
    calc(); 
    winform.edit.operator = null;
}

//æ¸…ç©ºé”™è¯¯è¾“å…¥
winform.buttonClearError.oncommand = function(id,event){
    winform.edit.text = &quot;0&quot;;
    winform.edit.state = &quot;result&quot;; //æ–‡æœ¬æ¡†å½“å‰è¾“å…¥çŠ¶æ€ï¼šæ˜¾ç¤ºç»“æœ
    winform.edit.setFocus();
}

//é‡ç½®
winform.buttonClear.oncommand = function(id,event){
    winform.edit.result = 0; //ç”¨äºä¿å­˜è®¡ç®—ç»“æœ
    winform.edit.operator = null; //å½“å‰æ²¡æœ‰æŒ‰ä¸‹ä»»ä½•æ“ä½œç¬¦

    winform.edit.text = &quot;0&quot;;
    winform.edit.state = &quot;result&quot;; //æ–‡æœ¬æ¡†å½“å‰è¾“å…¥çŠ¶æ€ï¼šæ˜¾ç¤ºç»“æœ
    for(name,ctrl in winform.eachControl(&quot;button&quot;) ) ctrl.disabled = false;
    winform.edit.setFocus();
}

winform.buttonClear.oncommand();

//è®¾å®šå¿«æµé”®
import win.ui.accelerator;
win.ui.accelerator({
    { vkey = 0x60/*_VK_NUMPAD0*/; oncommand = winform.button0.oncommand }  
    { vkey = 0x61/*_VK_NUMPAD1*/; oncommand = winform.button1.oncommand }  
    { vkey = 0x62/*_VK_NUMPAD2*/; oncommand = winform.button2.oncommand }  
    { vkey = 0x63/*_VK_NUMPAD3*/; oncommand = winform.button3.oncommand }  
    { vkey = 0x64/*_VK_NUMPAD4*/; oncommand = winform.button4.oncommand }  
    { vkey = 0x65/*_VK_NUMPAD5*/; oncommand = winform.button5.oncommand }  
    { vkey = 0x66/*_VK_NUMPAD6*/; oncommand = winform.button6.oncommand }  
    { vkey = 0x67/*_VK_NUMPAD7*/; oncommand = winform.button7.oncommand }  
    { vkey = 0x68/*_VK_NUMPAD8*/; oncommand = winform.button8.oncommand }  
    { vkey = 0x69/*_VK_NUMPAD9*/; oncommand = winform.button9.oncommand }
    { vkey = 0x6B/*_VK_ADD*/; oncommand = winform.buttonAdd.oncommand } 
    { vkey = 0x6D/*_VK_SUBTRACT*/; oncommand = winform.buttonSub.oncommand }  
    { vkey = 0x6A/*_VK_MULTIPLY*/; oncommand = winform.buttonMul.oncommand } 
    { vkey = 0x6F/*_VK_DIVIDE*/; oncommand = winform.buttonDiv.oncommand } 
    { shift=true;vkey = 0xBB/*_VK_OEM_PLUS*/; oncommand = winform.buttonAdd.oncommand }
    { vkey = 0xBD/*_VK_OEM_MINU*/; oncommand = winform.buttonSub.oncommand } 
    { shift=true;vkey = &#39;8&#39;#; oncommand = winform.buttonMul.oncommand }
    { vkey = 191/*_VK_OEM_2*/; oncommand = winform.buttonDiv.oncommand }
    { vkey = 0xBB/*_VK_OEM_PLUS*/; oncommand = winform.buttonEval.oncommand }  
    { vkey = 0x6E/*_VK_DECIMAL*/; oncommand = winform.buttonDot.oncommand } 
},winform);

winform.edit.setFocus();

::Imm32 := ..raw.loadDll(&quot;Imm32.dll&quot;);
::Imm32.ImmAssociateContext(winform.edit.hwnd,null);

winform.show();
win.loopMessage();
</code></pre>
<a href="javascript:if(confirm('https://www.aardio.com/zh-cn/doc/example/Windows/Application/calc.md  \n\n¸ÃÎÄ¼şÎŞ·¨ÓÃ Teleport Ultra ÏÂÔØ, ÒòÎª ·şÎñÆ÷±¨¸æ·ÃÎÊµÄÎÄ¼şÊÇÒş²ØµÄ¡£  \n\nÄãÏëÔÚ·şÎñÆ÷ÉÏ´ò¿ªËü?'))window.location='https://www.aardio.com/zh-cn/doc/example/Windows/Application/calc.md'" tppabs="https://www.aardio.com/zh-cn/doc/example/Windows/Application/calc.md">Markdown æ ¼å¼</a>
</body> 
</html>