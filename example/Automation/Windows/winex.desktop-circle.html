
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言范例 - 桌面图标排圆圈'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言范例 - 桌面图标排圆圈</title> 
<link rel="stylesheet" href="../../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>aardio 范例: 桌面图标排圆圈</h1><pre><code class="aardio language-aardio">//桌面图标排圆圈
//根据 4920614 代码修改 http://www.aardio.com/bbs/showtopic-9744.aspx
import winex;
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;桌面图标排圆圈&quot;;right=333;bottom=93;)
winform.add(
autoOrder={cls=&quot;button&quot;;text=&quot;恢复自动排列&quot;;left=203;top=46;right=316;bottom=72;font=LOGFONT(name=&#39;宋体&#39;);z=2};
button={cls=&quot;button&quot;;text=&quot;桌面图标排个圈圈&quot;;left=202;top=10;right=315;bottom=36;font=LOGFONT(name=&#39;宋体&#39;);z=1};
editR={cls=&quot;edit&quot;;text=&quot;300&quot;;left=119;top=12;right=170;bottom=34;edge=1;font=LOGFONT(name=&#39;宋体&#39;);z=3};
static={cls=&quot;static&quot;;text=&quot;圈圈半径(px):&quot;;left=33;top=17;right=111;bottom=33;font=LOGFONT(name=&#39;宋体&#39;);transparent=1;z=4}
)
/*}}*/

//注意不支持替换了系统桌面的各种 XX 桌面。
import winex.desktop;
winform.button.oncommand = function(id,event){

    //取消桌面右键对齐到网格 
    winex.desktop.listview.setExtended(0x80000/*_LVS_EX_SNAPTOGRID*/,false);

    //取消桌面自动排列
    winex.desktop.listview.modifyStyle(0x100/*_LVS_AUTOARRANGE*/); 

    var scrWidth,scrHeight = win.getScreen()
    var centerX = scrWidth/2;
    var centerY = scrHeight/2;
    var r =  math.min(
        tonumber(winform.editR.text),
        math.min(centerX,centerY)
    ) 

    //桌面图标个数
    var count = winex.desktop.listview.count; 

    //相邻图标间的弧度 2π/count
    var rad = 2*math.pi/count;  

    for(i=1;count ){
        var x=centerX+math.floor(r*math.sin(i*rad));
        var y=centerY+math.floor(r*math.cos(i*rad));
        winex.desktop.listview.setItemPos(i,x,y); 
        win.delay(10);
    }  
} 

//恢复自动排列
winform.autoOrder.oncommand = function(id,event){
    winex.desktop.listview.modifyStyle( , 0x100/*_LVS_AUTOARRANGE*/ );
    winex.desktop.listview.setExtended(0x80000/*_LVS_EX_SNAPTOGRID*/,true)  
}

winform.show(); 
win.loopMessage();

</code></pre>
<a href="winex.desktop-circle.md" tppabs="https://www.aardio.com/zh-cn/doc/example/Automation/Windows/winex.desktop-circle.md">Markdown 格式</a>
</body> 
</html>