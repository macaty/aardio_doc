
<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8">
<meta name="robots" content="index, follow">
<meta name='description' content='aardio 编程语言范例 - web.view - 操作 Excel 表格'>
<meta http-equiv='content-language' content='zh-cn'>
<title>aardio 编程语言范例 - web.view - 操作 Excel 表格</title> 
<link rel="stylesheet" href="../../css/markdown.css" tppabs="https://www.aardio.com/zh-cn/doc/css/markdown.css">
<script src="../../js/prism.js" tppabs="https://www.aardio.com/zh-cn/doc/js/prism.js"></script>
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/fontawesome.min.css">
<link rel="stylesheet" href="../../../../../lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css" tppabs="https://lib.baomitu.com/font-awesome/6.6.0/css/solid.min.css">
</head>
<body class="markdown-body"><a id="back-to-home" href="../../index.htm" tppabs="https://www.aardio.com/zh-cn/doc/" title="aardio 编程语言文档首页"><i class="fas fa-home" id="home-icon"></i><i class="fas fa-robot" id="ai-icon" style="display: none;"></i><span id="aardio-document-home">aardio 文档</span></a>
<h1>aardio 范例: web.view - 操作 Excel 表格</h1><pre><code class="aardio language-aardio">//SheetJS
import win.ui;
/*DSG{{*/
var winform = win.form(text=&quot;web.view - 操作 Excel 表格&quot;;right=800;bottom=469;bgcolor=16777215)
winform.add()
/*}}*/

import web.view;
var wb = web.view(winform);

//导出 aardio 函数给 JavaScript
wb.external = {
    saveXlsxFile = function(buffer,filename){ 
        import crypt;
        import process;

        var buffer = crypt.decodeBin(buffer);
        string.save(filename,buffer);

        process.exploreSelect(filename);
    }; 
}

wb.html = /**
&lt;!doctype html&gt;
&lt;html&gt;
&lt;head&gt;
    &lt;meta charset=&quot;utf-8&quot;&gt;
    &lt;style type=&quot;text/css&quot;&gt;
    html,body{ height:100%; margin:0; } 
    &lt;/style&gt;
    &lt;script src=&quot;https://cdn.bootcdn.net/ajax/libs/xlsx/0.18.5/xlsx.full.min.js&quot;&gt;&lt;/script&gt;
    &lt;script src=&quot;https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/handsontable/8.3.2/handsontable.full.min.js&quot;&gt;&lt;/script&gt;
    &lt;link rel=&quot;stylesheet&quot; href=&quot;https://lf26-cdn-tos.bytecdntp.com/cdn/expire-1-M/handsontable/8.3.2/handsontable.full.min.css&quot; /&gt;
&lt;/head&gt;
&lt;body&gt;
    &lt;div id=&quot;header&quot;&gt;&lt;/div&gt;
    &lt;div id=&quot;container&quot;&gt; 
        &lt;div class=&quot;lside&quot;&gt; &lt;/div&gt; 
        &lt;div class=&quot;rside&quot;&gt; &lt;/div&gt;  
    &lt;/div&gt;
&lt;/body&gt;

&lt;script type=&quot;text/javascript&quot;&gt;

    //https://docs.sheetjs.com/docs/api/parse-options

    let data = [
        [&#39;bookType&#39;, &#39;extension&#39;, &#39;sheets&#39;, &#39;Description&#39;],
        [&#39;xlsx&#39;, &#39;.xlsx&#39;, &#39;multi&#39;, &#39;Excel 2007+ XML Format&#39;],
        [&#39;xlsb&#39;, &#39;.xlsb&#39;, &#39;multi&#39;, &#39;Excel 2007+ Binary Format&#39;],
    ]    

    //创建工作簿
    let book = XLSX.utils.book_new()

    //创建工作表 
    let sheet = XLSX.utils.aoa_to_sheet(data) 
    XLSX.utils.book_append_sheet(book, sheet, &#39;Sheet1&#39;) 

    //输出为文件
    var xlsxData = XLSX.write(book,{bookType:&quot;xlsx&quot;,type:&quot;base64&quot;}) 

    //作为参数传给 aardio 函数
    aardio.saveXlsxFile(xlsxData,&quot;/test.xlsx&quot;)  

    //读取 XLSX 文件
    let book2 = XLSX.read(xlsxData , {bookType:&quot;xlsx&quot;,type:&quot;base64&quot;})

    //输出为 HTML 表格
    let sheet1 = book2.Sheets[book2.SheetNames[0]]
    //document.body.innerHTML = XLSX.utils.sheet_to_html( sheet1 ); 

    //转换为数组
    let array = XLSX.utils.sheet_to_json(sheet1);

    //显示 Excel 
    const hot = new Handsontable(document.body, {
        data: array,
        rowHeaders: true,
        colHeaders: true,
        height: &#39;auto&#39;,
        autoWrapRow: true,
        autoWrapCol: true,
        licenseKey: &#39;non-commercial-and-evaluation&#39; 
    });
&lt;/script&gt;
&lt;/html&gt;
**/

winform.show();
win.loopMessage();
</code></pre>
<a href="SheetJS.md" tppabs="https://www.aardio.com/zh-cn/doc/example/Excel/SheetJS.md">Markdown 格式</a>
</body> 
</html>